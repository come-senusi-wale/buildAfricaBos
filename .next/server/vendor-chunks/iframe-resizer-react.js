"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/iframe-resizer-react";
exports.ids = ["vendor-chunks/iframe-resizer-react"];
exports.modules = {

/***/ "(ssr)/./node_modules/iframe-resizer-react/dist/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/iframe-resizer-react/dist/index.js ***!
  \*********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\n\nvar PropTypes = __webpack_require__(/*! prop-types */ \"(ssr)/./node_modules/prop-types/index.js\");\nvar React = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar PropTypes__default = /*#__PURE__*/_interopDefaultLegacy(PropTypes);\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar iframeResizer = createCommonjsModule(function (module) {\n(function (undefined$1) {\n  if (typeof window === 'undefined') return // don't run for server side render\n\n  var count = 0,\n    logEnabled = false,\n    hiddenCheckEnabled = false,\n    msgHeader = 'message',\n    msgHeaderLen = msgHeader.length,\n    msgId = '[iFrameSizer]', // Must match iframe msg ID\n    msgIdLen = msgId.length,\n    pagePosition = null,\n    requestAnimationFrame = window.requestAnimationFrame,\n    resetRequiredMethods = {\n      max: 1,\n      scroll: 1,\n      bodyScroll: 1,\n      documentElementScroll: 1\n    },\n    settings = {},\n    timer = null,\n    defaults = {\n      autoResize: true,\n      bodyBackground: null,\n      bodyMargin: null,\n      bodyMarginV1: 8,\n      bodyPadding: null,\n      checkOrigin: true,\n      inPageLinks: false,\n      enablePublicMethods: true,\n      heightCalculationMethod: 'bodyOffset',\n      id: 'iFrameResizer',\n      interval: 32,\n      log: false,\n      maxHeight: Infinity,\n      maxWidth: Infinity,\n      minHeight: 0,\n      minWidth: 0,\n      resizeFrom: 'parent',\n      scrolling: false,\n      sizeHeight: true,\n      sizeWidth: false,\n      warningTimeout: 5000,\n      tolerance: 0,\n      widthCalculationMethod: 'scroll',\n      onClose: function () {\n        return true\n      },\n      onClosed: function () {},\n      onInit: function () {},\n      onMessage: function () {\n        warn('onMessage function not defined');\n      },\n      onMouseEnter: function () {},\n      onMouseLeave: function () {},\n      onResized: function () {},\n      onScroll: function () {\n        return true\n      }\n    };\n\n  function getMutationObserver() {\n    return (\n      window.MutationObserver ||\n      window.WebKitMutationObserver ||\n      window.MozMutationObserver\n    )\n  }\n\n  function addEventListener(el, evt, func) {\n    el.addEventListener(evt, func, false);\n  }\n\n  function removeEventListener(el, evt, func) {\n    el.removeEventListener(evt, func, false);\n  }\n\n  function setupRequestAnimationFrame() {\n    var vendors = ['moz', 'webkit', 'o', 'ms'];\n    var x;\n\n    // Remove vendor prefixing if prefixed and break early if not\n    for (x = 0; x < vendors.length && !requestAnimationFrame; x += 1) {\n      requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n    }\n\n    if (!requestAnimationFrame) {\n      log('setup', 'RequestAnimationFrame not supported');\n    } else {\n      // Firefox extension content-scripts have a globalThis object that is not the same as window.\n      // Binding `requestAnimationFrame` to window allows the function to work and prevents errors\n      // being thrown when run in that context, and should be a no-op in every other context.\n      requestAnimationFrame = requestAnimationFrame.bind(window);\n    }\n  }\n\n  function getMyID(iframeId) {\n    var retStr = 'Host page: ' + iframeId;\n\n    if (window.top !== window.self) {\n      // eslint-disable-next-line unicorn/prefer-ternary\n      if (window.parentIFrame && window.parentIFrame.getId) {\n        retStr = window.parentIFrame.getId() + ': ' + iframeId;\n      } else {\n        retStr = 'Nested host page: ' + iframeId;\n      }\n    }\n\n    return retStr\n  }\n\n  function formatLogHeader(iframeId) {\n    return msgId + '[' + getMyID(iframeId) + ']'\n  }\n\n  function isLogEnabled(iframeId) {\n    return settings[iframeId] ? settings[iframeId].log : logEnabled\n  }\n\n  function log(iframeId, msg) {\n    output('log', iframeId, msg, isLogEnabled(iframeId));\n  }\n\n  function info(iframeId, msg) {\n    output('info', iframeId, msg, isLogEnabled(iframeId));\n  }\n\n  function warn(iframeId, msg) {\n    output('warn', iframeId, msg, true);\n  }\n\n  function output(type, iframeId, msg, enabled) {\n    if (true === enabled && 'object' === typeof window.console) {\n      // eslint-disable-next-line no-console\n      console[type](formatLogHeader(iframeId), msg);\n    }\n  }\n\n  function iFrameListener(event) {\n    function resizeIFrame() {\n      function resize() {\n        setSize(messageData);\n        setPagePosition(iframeId);\n        on('onResized', messageData);\n      }\n\n      ensureInRange('Height');\n      ensureInRange('Width');\n\n      syncResize(resize, messageData, 'init');\n    }\n\n    function processMsg() {\n      var data = msg.substr(msgIdLen).split(':');\n      var height = data[1] ? parseInt(data[1], 10) : 0;\n      var iframe = settings[data[0]] && settings[data[0]].iframe;\n      var compStyle = getComputedStyle(iframe);\n\n      return {\n        iframe: iframe,\n        id: data[0],\n        height: height + getPaddingEnds(compStyle) + getBorderEnds(compStyle),\n        width: data[2],\n        type: data[3]\n      }\n    }\n\n    function getPaddingEnds(compStyle) {\n      if (compStyle.boxSizing !== 'border-box') {\n        return 0\n      }\n      var top = compStyle.paddingTop ? parseInt(compStyle.paddingTop, 10) : 0;\n      var bot = compStyle.paddingBottom\n        ? parseInt(compStyle.paddingBottom, 10)\n        : 0;\n      return top + bot\n    }\n\n    function getBorderEnds(compStyle) {\n      if (compStyle.boxSizing !== 'border-box') {\n        return 0\n      }\n      var top = compStyle.borderTopWidth\n        ? parseInt(compStyle.borderTopWidth, 10)\n        : 0;\n      var bot = compStyle.borderBottomWidth\n        ? parseInt(compStyle.borderBottomWidth, 10)\n        : 0;\n      return top + bot\n    }\n\n    function ensureInRange(Dimension) {\n      var max = Number(settings[iframeId]['max' + Dimension]),\n        min = Number(settings[iframeId]['min' + Dimension]),\n        dimension = Dimension.toLowerCase(),\n        size = Number(messageData[dimension]);\n\n      log(iframeId, 'Checking ' + dimension + ' is in range ' + min + '-' + max);\n\n      if (size < min) {\n        size = min;\n        log(iframeId, 'Set ' + dimension + ' to min value');\n      }\n\n      if (size > max) {\n        size = max;\n        log(iframeId, 'Set ' + dimension + ' to max value');\n      }\n\n      messageData[dimension] = '' + size;\n    }\n\n    function isMessageFromIFrame() {\n      function checkAllowedOrigin() {\n        function checkList() {\n          var i = 0,\n            retCode = false;\n\n          log(\n            iframeId,\n            'Checking connection is from allowed list of origins: ' +\n              checkOrigin\n          );\n\n          for (; i < checkOrigin.length; i++) {\n            if (checkOrigin[i] === origin) {\n              retCode = true;\n              break\n            }\n          }\n          return retCode\n        }\n\n        function checkSingle() {\n          var remoteHost = settings[iframeId] && settings[iframeId].remoteHost;\n          log(iframeId, 'Checking connection is from: ' + remoteHost);\n          return origin === remoteHost\n        }\n\n        return checkOrigin.constructor === Array ? checkList() : checkSingle()\n      }\n\n      var origin = event.origin,\n        checkOrigin = settings[iframeId] && settings[iframeId].checkOrigin;\n\n      if (checkOrigin && '' + origin !== 'null' && !checkAllowedOrigin()) {\n        throw new Error(\n          'Unexpected message received from: ' +\n            origin +\n            ' for ' +\n            messageData.iframe.id +\n            '. Message was: ' +\n            event.data +\n            '. This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.'\n        )\n      }\n\n      return true\n    }\n\n    function isMessageForUs() {\n      return (\n        msgId === ('' + msg).substr(0, msgIdLen) &&\n        msg.substr(msgIdLen).split(':')[0] in settings\n      ) // ''+Protects against non-string msg\n    }\n\n    function isMessageFromMetaParent() {\n      // Test if this message is from a parent above us. This is an ugly test, however, updating\n      // the message format would break backwards compatibity.\n      var retCode = messageData.type in { true: 1, false: 1, undefined: 1 };\n\n      if (retCode) {\n        log(iframeId, 'Ignoring init message from meta parent page');\n      }\n\n      return retCode\n    }\n\n    function getMsgBody(offset) {\n      return msg.substr(msg.indexOf(':') + msgHeaderLen + offset)\n    }\n\n    function forwardMsgFromIFrame(msgBody) {\n      log(\n        iframeId,\n        'onMessage passed: {iframe: ' +\n          messageData.iframe.id +\n          ', message: ' +\n          msgBody +\n          '}'\n      );\n\n      on('onMessage', {\n        iframe: messageData.iframe,\n        message: JSON.parse(msgBody)\n      });\n\n      log(iframeId, '--');\n    }\n\n    function getPageInfo() {\n      var bodyPosition = document.body.getBoundingClientRect(),\n        iFramePosition = messageData.iframe.getBoundingClientRect();\n\n      return JSON.stringify({\n        iframeHeight: iFramePosition.height,\n        iframeWidth: iFramePosition.width,\n        clientHeight: Math.max(\n          document.documentElement.clientHeight,\n          window.innerHeight || 0\n        ),\n        clientWidth: Math.max(\n          document.documentElement.clientWidth,\n          window.innerWidth || 0\n        ),\n        offsetTop: parseInt(iFramePosition.top - bodyPosition.top, 10),\n        offsetLeft: parseInt(iFramePosition.left - bodyPosition.left, 10),\n        scrollTop: window.pageYOffset,\n        scrollLeft: window.pageXOffset,\n        documentHeight: document.documentElement.clientHeight,\n        documentWidth: document.documentElement.clientWidth,\n        windowHeight: window.innerHeight,\n        windowWidth: window.innerWidth\n      })\n    }\n\n    function sendPageInfoToIframe(iframe, iframeId) {\n      function debouncedTrigger() {\n        trigger('Send Page Info', 'pageInfo:' + getPageInfo(), iframe, iframeId);\n      }\n      debounceFrameEvents(debouncedTrigger, 32, iframeId);\n    }\n\n    function startPageInfoMonitor() {\n      function setListener(type, func) {\n        function sendPageInfo() {\n          if (settings[id]) {\n            sendPageInfoToIframe(settings[id].iframe, id);\n          } else {\n            stop();\n          }\n        }\n['scroll', 'resize'].forEach(function (evt) {\n          log(id, type + evt + ' listener for sendPageInfo');\n          func(window, evt, sendPageInfo);\n        });\n      }\n\n      function stop() {\n        setListener('Remove ', removeEventListener);\n      }\n\n      function start() {\n        setListener('Add ', addEventListener);\n      }\n\n      var id = iframeId; // Create locally scoped copy of iFrame ID\n\n      start();\n\n      if (settings[id]) {\n        settings[id].stopPageInfo = stop;\n      }\n    }\n\n    function stopPageInfoMonitor() {\n      if (settings[iframeId] && settings[iframeId].stopPageInfo) {\n        settings[iframeId].stopPageInfo();\n        delete settings[iframeId].stopPageInfo;\n      }\n    }\n\n    function checkIFrameExists() {\n      var retBool = true;\n\n      if (null === messageData.iframe) {\n        warn(iframeId, 'IFrame (' + messageData.id + ') not found');\n        retBool = false;\n      }\n      return retBool\n    }\n\n    function getElementPosition(target) {\n      var iFramePosition = target.getBoundingClientRect();\n\n      getPagePosition(iframeId);\n\n      return {\n        x: Math.floor(Number(iFramePosition.left) + Number(pagePosition.x)),\n        y: Math.floor(Number(iFramePosition.top) + Number(pagePosition.y))\n      }\n    }\n\n    function scrollRequestFromChild(addOffset) {\n      /* istanbul ignore next */ // Not testable in Karma\n      function reposition() {\n        pagePosition = newPosition;\n        scrollTo();\n        log(iframeId, '--');\n      }\n\n      function calcOffset() {\n        return {\n          x: Number(messageData.width) + offset.x,\n          y: Number(messageData.height) + offset.y\n        }\n      }\n\n      function scrollParent() {\n        if (window.parentIFrame) {\n          window.parentIFrame['scrollTo' + (addOffset ? 'Offset' : '')](\n            newPosition.x,\n            newPosition.y\n          );\n        } else {\n          warn(\n            iframeId,\n            'Unable to scroll to requested position, window.parentIFrame not found'\n          );\n        }\n      }\n\n      var offset = addOffset\n          ? getElementPosition(messageData.iframe)\n          : { x: 0, y: 0 },\n        newPosition = calcOffset();\n\n      log(\n        iframeId,\n        'Reposition requested from iFrame (offset x:' +\n          offset.x +\n          ' y:' +\n          offset.y +\n          ')'\n      );\n\n      if (window.top !== window.self) {\n        scrollParent();\n      } else {\n        reposition();\n      }\n    }\n\n    function scrollTo() {\n      if (false !== on('onScroll', pagePosition)) {\n        setPagePosition(iframeId);\n      } else {\n        unsetPagePosition();\n      }\n    }\n\n    function findTarget(location) {\n      function jumpToTarget() {\n        var jumpPosition = getElementPosition(target);\n\n        log(\n          iframeId,\n          'Moving to in page link (#' +\n            hash +\n            ') at x: ' +\n            jumpPosition.x +\n            ' y: ' +\n            jumpPosition.y\n        );\n        pagePosition = {\n          x: jumpPosition.x,\n          y: jumpPosition.y\n        };\n\n        scrollTo();\n        log(iframeId, '--');\n      }\n\n      function jumpToParent() {\n        if (window.parentIFrame) {\n          window.parentIFrame.moveToAnchor(hash);\n        } else {\n          log(\n            iframeId,\n            'In page link #' +\n              hash +\n              ' not found and window.parentIFrame not found'\n          );\n        }\n      }\n\n      var hash = location.split('#')[1] || '',\n        hashData = decodeURIComponent(hash),\n        target =\n          document.getElementById(hashData) ||\n          document.getElementsByName(hashData)[0];\n\n      if (target) {\n        jumpToTarget();\n      } else if (window.top !== window.self) {\n        jumpToParent();\n      } else {\n        log(iframeId, 'In page link #' + hash + ' not found');\n      }\n    }\n\n    function onMouse(event) {\n      on(event, {\n        iframe: messageData.iframe,\n        screenX: messageData.width,\n        screenY: messageData.height,\n        type: messageData.type\n      });\n    }\n\n    function on(funcName, val) {\n      return chkEvent(iframeId, funcName, val)\n    }\n\n    function actionMsg() {\n      if (settings[iframeId] && settings[iframeId].firstRun) firstRun();\n\n      switch (messageData.type) {\n        case 'close':\n          closeIFrame(messageData.iframe);\n          break\n\n        case 'message':\n          forwardMsgFromIFrame(getMsgBody(6));\n          break\n\n        case 'mouseenter':\n          onMouse('onMouseEnter');\n          break\n\n        case 'mouseleave':\n          onMouse('onMouseLeave');\n          break\n\n        case 'autoResize':\n          settings[iframeId].autoResize = JSON.parse(getMsgBody(9));\n          break\n\n        case 'scrollTo':\n          scrollRequestFromChild(false);\n          break\n\n        case 'scrollToOffset':\n          scrollRequestFromChild(true);\n          break\n\n        case 'pageInfo':\n          sendPageInfoToIframe(\n            settings[iframeId] && settings[iframeId].iframe,\n            iframeId\n          );\n          startPageInfoMonitor();\n          break\n\n        case 'pageInfoStop':\n          stopPageInfoMonitor();\n          break\n\n        case 'inPageLink':\n          findTarget(getMsgBody(9));\n          break\n\n        case 'reset':\n          resetIFrame(messageData);\n          break\n\n        case 'init':\n          resizeIFrame();\n          on('onInit', messageData.iframe);\n          break\n\n        default:\n          resizeIFrame();\n      }\n    }\n\n    function hasSettings(iframeId) {\n      var retBool = true;\n\n      if (!settings[iframeId]) {\n        retBool = false;\n        warn(\n          messageData.type +\n            ' No settings for ' +\n            iframeId +\n            '. Message was: ' +\n            msg\n        );\n      }\n\n      return retBool\n    }\n\n    function iFrameReadyMsgReceived() {\n      // eslint-disable-next-line no-restricted-syntax, guard-for-in\n      for (var iframeId in settings) {\n        trigger(\n          'iFrame requested init',\n          createOutgoingMsg(iframeId),\n          settings[iframeId].iframe,\n          iframeId\n        );\n      }\n    }\n\n    function firstRun() {\n      if (settings[iframeId]) {\n        settings[iframeId].firstRun = false;\n      }\n    }\n\n    var msg = event.data,\n      messageData = {},\n      iframeId = null;\n\n    if ('[iFrameResizerChild]Ready' === msg) {\n      iFrameReadyMsgReceived();\n    } else if (isMessageForUs()) {\n      messageData = processMsg();\n      iframeId = messageData.id;\n      if (settings[iframeId]) {\n        settings[iframeId].loaded = true;\n      }\n\n      if (!isMessageFromMetaParent() && hasSettings(iframeId)) {\n        log(iframeId, 'Received: ' + msg);\n\n        if (checkIFrameExists() && isMessageFromIFrame()) {\n          actionMsg();\n        }\n      }\n    } else {\n      info(iframeId, 'Ignored: ' + msg);\n    }\n  }\n\n  function chkEvent(iframeId, funcName, val) {\n    var func = null,\n      retVal = null;\n\n    if (settings[iframeId]) {\n      func = settings[iframeId][funcName];\n\n      if ('function' === typeof func) {\n        retVal = func(val);\n      } else {\n        throw new TypeError(\n          funcName + ' on iFrame[' + iframeId + '] is not a function'\n        )\n      }\n    }\n\n    return retVal\n  }\n\n  function removeIframeListeners(iframe) {\n    var iframeId = iframe.id;\n    delete settings[iframeId];\n  }\n\n  function closeIFrame(iframe) {\n    var iframeId = iframe.id;\n    if (chkEvent(iframeId, 'onClose', iframeId) === false) {\n      log(iframeId, 'Close iframe cancelled by onClose event');\n      return\n    }\n    log(iframeId, 'Removing iFrame: ' + iframeId);\n\n    try {\n      // Catch race condition error with React\n      if (iframe.parentNode) {\n        iframe.parentNode.removeChild(iframe);\n      }\n    } catch (error) {\n      warn(error);\n    }\n\n    chkEvent(iframeId, 'onClosed', iframeId);\n    log(iframeId, '--');\n    removeIframeListeners(iframe);\n  }\n\n  function getPagePosition(iframeId) {\n    if (null === pagePosition) {\n      pagePosition = {\n        x:\n          window.pageXOffset !== undefined$1\n            ? window.pageXOffset\n            : document.documentElement.scrollLeft,\n        y:\n          window.pageYOffset !== undefined$1\n            ? window.pageYOffset\n            : document.documentElement.scrollTop\n      };\n      log(\n        iframeId,\n        'Get page position: ' + pagePosition.x + ',' + pagePosition.y\n      );\n    }\n  }\n\n  function setPagePosition(iframeId) {\n    if (null !== pagePosition) {\n      window.scrollTo(pagePosition.x, pagePosition.y);\n      log(\n        iframeId,\n        'Set page position: ' + pagePosition.x + ',' + pagePosition.y\n      );\n      unsetPagePosition();\n    }\n  }\n\n  function unsetPagePosition() {\n    pagePosition = null;\n  }\n\n  function resetIFrame(messageData) {\n    function reset() {\n      setSize(messageData);\n      trigger('reset', 'reset', messageData.iframe, messageData.id);\n    }\n\n    log(\n      messageData.id,\n      'Size reset requested by ' +\n        ('init' === messageData.type ? 'host page' : 'iFrame')\n    );\n    getPagePosition(messageData.id);\n    syncResize(reset, messageData, 'reset');\n  }\n\n  function setSize(messageData) {\n    function setDimension(dimension) {\n      if (!messageData.id) {\n        log('undefined', 'messageData id not set');\n        return\n      }\n      messageData.iframe.style[dimension] = messageData[dimension] + 'px';\n      log(\n        messageData.id,\n        'IFrame (' +\n          iframeId +\n          ') ' +\n          dimension +\n          ' set to ' +\n          messageData[dimension] +\n          'px'\n      );\n    }\n\n    function chkZero(dimension) {\n      // FireFox sets dimension of hidden iFrames to zero.\n      // So if we detect that set up an event to check for\n      // when iFrame becomes visible.\n\n      /* istanbul ignore next */ // Not testable in PhantomJS\n      if (!hiddenCheckEnabled && '0' === messageData[dimension]) {\n        hiddenCheckEnabled = true;\n        log(iframeId, 'Hidden iFrame detected, creating visibility listener');\n        fixHiddenIFrames();\n      }\n    }\n\n    function processDimension(dimension) {\n      setDimension(dimension);\n      chkZero(dimension);\n    }\n\n    var iframeId = messageData.iframe.id;\n\n    if (settings[iframeId]) {\n      if (settings[iframeId].sizeHeight) {\n        processDimension('height');\n      }\n      if (settings[iframeId].sizeWidth) {\n        processDimension('width');\n      }\n    }\n  }\n\n  function syncResize(func, messageData, doNotSync) {\n    /* istanbul ignore if */ // Not testable in PhantomJS\n    if (\n      doNotSync !== messageData.type &&\n      requestAnimationFrame &&\n      // including check for jasmine because had trouble getting spy to work in unit test using requestAnimationFrame\n      !window.jasmine\n    ) {\n      log(messageData.id, 'Requesting animation frame');\n      requestAnimationFrame(func);\n    } else {\n      func();\n    }\n  }\n\n  function trigger(calleeMsg, msg, iframe, id, noResponseWarning) {\n    function postMessageToIFrame() {\n      var target = settings[id] && settings[id].targetOrigin;\n      log(\n        id,\n        '[' +\n          calleeMsg +\n          '] Sending msg to iframe[' +\n          id +\n          '] (' +\n          msg +\n          ') targetOrigin: ' +\n          target\n      );\n      iframe.contentWindow.postMessage(msgId + msg, target);\n    }\n\n    function iFrameNotFound() {\n      warn(id, '[' + calleeMsg + '] IFrame(' + id + ') not found');\n    }\n\n    function chkAndSend() {\n      if (\n        iframe &&\n        'contentWindow' in iframe &&\n        null !== iframe.contentWindow\n      ) {\n        // Null test for PhantomJS\n        postMessageToIFrame();\n      } else {\n        iFrameNotFound();\n      }\n    }\n\n    function warnOnNoResponse() {\n      function warning() {\n        if (settings[id] && !settings[id].loaded && !errorShown) {\n          errorShown = true;\n          warn(\n            id,\n            'IFrame has not responded within ' +\n              settings[id].warningTimeout / 1000 +\n              ' seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning.'\n          );\n        }\n      }\n\n      if (\n        !!noResponseWarning &&\n        settings[id] &&\n        !!settings[id].warningTimeout\n      ) {\n        settings[id].msgTimeout = setTimeout(\n          warning,\n          settings[id].warningTimeout\n        );\n      }\n    }\n\n    var errorShown = false;\n\n    id = id || iframe.id;\n\n    if (settings[id]) {\n      chkAndSend();\n      warnOnNoResponse();\n    }\n  }\n\n  function createOutgoingMsg(iframeId) {\n    return (\n      iframeId +\n      ':' +\n      settings[iframeId].bodyMarginV1 +\n      ':' +\n      settings[iframeId].sizeWidth +\n      ':' +\n      settings[iframeId].log +\n      ':' +\n      settings[iframeId].interval +\n      ':' +\n      settings[iframeId].enablePublicMethods +\n      ':' +\n      settings[iframeId].autoResize +\n      ':' +\n      settings[iframeId].bodyMargin +\n      ':' +\n      settings[iframeId].heightCalculationMethod +\n      ':' +\n      settings[iframeId].bodyBackground +\n      ':' +\n      settings[iframeId].bodyPadding +\n      ':' +\n      settings[iframeId].tolerance +\n      ':' +\n      settings[iframeId].inPageLinks +\n      ':' +\n      settings[iframeId].resizeFrom +\n      ':' +\n      settings[iframeId].widthCalculationMethod\n    )\n  }\n\n  function setupIFrame(iframe, options) {\n    function setLimits() {\n      function addStyle(style) {\n        if (\n          Infinity !== settings[iframeId][style] &&\n          0 !== settings[iframeId][style]\n        ) {\n          iframe.style[style] = settings[iframeId][style] + 'px';\n          log(\n            iframeId,\n            'Set ' + style + ' = ' + settings[iframeId][style] + 'px'\n          );\n        }\n      }\n\n      function chkMinMax(dimension) {\n        if (\n          settings[iframeId]['min' + dimension] >\n          settings[iframeId]['max' + dimension]\n        ) {\n          throw new Error(\n            'Value for min' +\n              dimension +\n              ' can not be greater than max' +\n              dimension\n          )\n        }\n      }\n\n      chkMinMax('Height');\n      chkMinMax('Width');\n\n      addStyle('maxHeight');\n      addStyle('minHeight');\n      addStyle('maxWidth');\n      addStyle('minWidth');\n    }\n\n    function newId() {\n      var id = (options && options.id) || defaults.id + count++;\n      if (null !== document.getElementById(id)) {\n        id += count++;\n      }\n      return id\n    }\n\n    function ensureHasId(iframeId) {\n      if ('' === iframeId) {\n        // eslint-disable-next-line no-multi-assign\n        iframe.id = iframeId = newId();\n        logEnabled = (options || {}).log;\n        log(\n          iframeId,\n          'Added missing iframe ID: ' + iframeId + ' (' + iframe.src + ')'\n        );\n      }\n\n      return iframeId\n    }\n\n    function setScrolling() {\n      log(\n        iframeId,\n        'IFrame scrolling ' +\n          (settings[iframeId] && settings[iframeId].scrolling\n            ? 'enabled'\n            : 'disabled') +\n          ' for ' +\n          iframeId\n      );\n      iframe.style.overflow =\n        false === (settings[iframeId] && settings[iframeId].scrolling)\n          ? 'hidden'\n          : 'auto';\n      switch (settings[iframeId] && settings[iframeId].scrolling) {\n        case 'omit':\n          break\n\n        case true:\n          iframe.scrolling = 'yes';\n          break\n\n        case false:\n          iframe.scrolling = 'no';\n          break\n\n        default:\n          iframe.scrolling = settings[iframeId]\n            ? settings[iframeId].scrolling\n            : 'no';\n      }\n    }\n\n    // The V1 iFrame script expects an int, where as in V2 expects a CSS\n    // string value such as '1px 3em', so if we have an int for V2, set V1=V2\n    // and then convert V2 to a string PX value.\n    function setupBodyMarginValues() {\n      if (\n        'number' ===\n          typeof (settings[iframeId] && settings[iframeId].bodyMargin) ||\n        '0' === (settings[iframeId] && settings[iframeId].bodyMargin)\n      ) {\n        settings[iframeId].bodyMarginV1 = settings[iframeId].bodyMargin;\n        settings[iframeId].bodyMargin =\n          '' + settings[iframeId].bodyMargin + 'px';\n      }\n    }\n\n    function checkReset() {\n      // Reduce scope of firstRun to function, because IE8's JS execution\n      // context stack is borked and this value gets externally\n      // changed midway through running this function!!!\n      var firstRun = settings[iframeId] && settings[iframeId].firstRun,\n        resetRequertMethod =\n          settings[iframeId] &&\n          settings[iframeId].heightCalculationMethod in resetRequiredMethods;\n\n      if (!firstRun && resetRequertMethod) {\n        resetIFrame({ iframe: iframe, height: 0, width: 0, type: 'init' });\n      }\n    }\n\n    function setupIFrameObject() {\n      if (settings[iframeId]) {\n        settings[iframeId].iframe.iFrameResizer = {\n          close: closeIFrame.bind(null, settings[iframeId].iframe),\n\n          removeListeners: removeIframeListeners.bind(\n            null,\n            settings[iframeId].iframe\n          ),\n\n          resize: trigger.bind(\n            null,\n            'Window resize',\n            'resize',\n            settings[iframeId].iframe\n          ),\n\n          moveToAnchor: function (anchor) {\n            trigger(\n              'Move to anchor',\n              'moveToAnchor:' + anchor,\n              settings[iframeId].iframe,\n              iframeId\n            );\n          },\n\n          sendMessage: function (message) {\n            message = JSON.stringify(message);\n            trigger(\n              'Send Message',\n              'message:' + message,\n              settings[iframeId].iframe,\n              iframeId\n            );\n          }\n        };\n      }\n    }\n\n    // We have to call trigger twice, as we can not be sure if all\n    // iframes have completed loading when this code runs. The\n    // event listener also catches the page changing in the iFrame.\n    function init(msg) {\n      function iFrameLoaded() {\n        trigger('iFrame.onload', msg, iframe, undefined$1, true);\n        checkReset();\n      }\n\n      function createDestroyObserver(MutationObserver) {\n        if (!iframe.parentNode) {\n          return\n        }\n\n        var destroyObserver = new MutationObserver(function (mutations) {\n          mutations.forEach(function (mutation) {\n            var removedNodes = Array.prototype.slice.call(mutation.removedNodes); // Transform NodeList into an Array\n            removedNodes.forEach(function (removedNode) {\n              if (removedNode === iframe) {\n                closeIFrame(iframe);\n              }\n            });\n          });\n        });\n        destroyObserver.observe(iframe.parentNode, {\n          childList: true\n        });\n      }\n\n      var MutationObserver = getMutationObserver();\n      if (MutationObserver) {\n        createDestroyObserver(MutationObserver);\n      }\n\n      addEventListener(iframe, 'load', iFrameLoaded);\n      trigger('init', msg, iframe, undefined$1, true);\n    }\n\n    function checkOptions(options) {\n      if ('object' !== typeof options) {\n        throw new TypeError('Options is not an object')\n      }\n    }\n\n    function copyOptions(options) {\n      // eslint-disable-next-line no-restricted-syntax\n      for (var option in defaults) {\n        if (Object.prototype.hasOwnProperty.call(defaults, option)) {\n          settings[iframeId][option] = Object.prototype.hasOwnProperty.call(\n            options,\n            option\n          )\n            ? options[option]\n            : defaults[option];\n        }\n      }\n    }\n\n    function getTargetOrigin(remoteHost) {\n      return '' === remoteHost ||\n        null !== remoteHost.match(/^(about:blank|javascript:|file:\\/\\/)/)\n        ? '*'\n        : remoteHost\n    }\n\n    function depricate(key) {\n      var splitName = key.split('Callback');\n\n      if (splitName.length === 2) {\n        var name =\n          'on' + splitName[0].charAt(0).toUpperCase() + splitName[0].slice(1);\n        this[name] = this[key];\n        delete this[key];\n        warn(\n          iframeId,\n          \"Deprecated: '\" +\n            key +\n            \"' has been renamed '\" +\n            name +\n            \"'. The old method will be removed in the next major version.\"\n        );\n      }\n    }\n\n    function processOptions(options) {\n      options = options || {};\n      settings[iframeId] = {\n        firstRun: true,\n        iframe: iframe,\n        remoteHost: iframe.src && iframe.src.split('/').slice(0, 3).join('/')\n      };\n\n      checkOptions(options);\n      Object.keys(options).forEach(depricate, options);\n      copyOptions(options);\n\n      if (settings[iframeId]) {\n        settings[iframeId].targetOrigin =\n          true === settings[iframeId].checkOrigin\n            ? getTargetOrigin(settings[iframeId].remoteHost)\n            : '*';\n      }\n    }\n\n    function beenHere() {\n      return iframeId in settings && 'iFrameResizer' in iframe\n    }\n\n    var iframeId = ensureHasId(iframe.id);\n\n    if (!beenHere()) {\n      processOptions(options);\n      setScrolling();\n      setLimits();\n      setupBodyMarginValues();\n      init(createOutgoingMsg(iframeId));\n      setupIFrameObject();\n    } else {\n      warn(iframeId, 'Ignored iFrame, already setup.');\n    }\n  }\n\n  function debouce(fn, time) {\n    if (null === timer) {\n      timer = setTimeout(function () {\n        timer = null;\n        fn();\n      }, time);\n    }\n  }\n\n  var frameTimer = {};\n  function debounceFrameEvents(fn, time, frameId) {\n    if (!frameTimer[frameId]) {\n      frameTimer[frameId] = setTimeout(function () {\n        frameTimer[frameId] = null;\n        fn();\n      }, time);\n    }\n  }\n\n  // Not testable in PhantomJS\n  /* istanbul ignore next */\n\n  function fixHiddenIFrames() {\n    function checkIFrames() {\n      function checkIFrame(settingId) {\n        function chkDimension(dimension) {\n          return (\n            '0px' ===\n            (settings[settingId] && settings[settingId].iframe.style[dimension])\n          )\n        }\n\n        function isVisible(el) {\n          return null !== el.offsetParent\n        }\n\n        if (\n          settings[settingId] &&\n          isVisible(settings[settingId].iframe) &&\n          (chkDimension('height') || chkDimension('width'))\n        ) {\n          trigger(\n            'Visibility change',\n            'resize',\n            settings[settingId].iframe,\n            settingId\n          );\n        }\n      }\n\n      Object.keys(settings).forEach(function (key) {\n        checkIFrame(key);\n      });\n    }\n\n    function mutationObserved(mutations) {\n      log(\n        'window',\n        'Mutation observed: ' + mutations[0].target + ' ' + mutations[0].type\n      );\n      debouce(checkIFrames, 16);\n    }\n\n    function createMutationObserver() {\n      var target = document.querySelector('body'),\n        config = {\n          attributes: true,\n          attributeOldValue: false,\n          characterData: true,\n          characterDataOldValue: false,\n          childList: true,\n          subtree: true\n        },\n        observer = new MutationObserver(mutationObserved);\n\n      observer.observe(target, config);\n    }\n\n    var MutationObserver = getMutationObserver();\n    if (MutationObserver) {\n      createMutationObserver();\n    }\n  }\n\n  function resizeIFrames(event) {\n    function resize() {\n      sendTriggerMsg('Window ' + event, 'resize');\n    }\n\n    log('window', 'Trigger event: ' + event);\n    debouce(resize, 16);\n  }\n\n  // Not testable in PhantomJS\n  /* istanbul ignore next */\n  function tabVisible() {\n    function resize() {\n      sendTriggerMsg('Tab Visable', 'resize');\n    }\n\n    if ('hidden' !== document.visibilityState) {\n      log('document', 'Trigger event: Visiblity change');\n      debouce(resize, 16);\n    }\n  }\n\n  function sendTriggerMsg(eventName, event) {\n    function isIFrameResizeEnabled(iframeId) {\n      return (\n        settings[iframeId] &&\n        'parent' === settings[iframeId].resizeFrom &&\n        settings[iframeId].autoResize &&\n        !settings[iframeId].firstRun\n      )\n    }\n\n    Object.keys(settings).forEach(function (iframeId) {\n      if (isIFrameResizeEnabled(iframeId)) {\n        trigger(eventName, event, settings[iframeId].iframe, iframeId);\n      }\n    });\n  }\n\n  function setupEventListeners() {\n    addEventListener(window, 'message', iFrameListener);\n\n    addEventListener(window, 'resize', function () {\n      resizeIFrames('resize');\n    });\n\n    addEventListener(document, 'visibilitychange', tabVisible);\n\n    addEventListener(document, '-webkit-visibilitychange', tabVisible);\n  }\n\n  function factory() {\n    function init(options, element) {\n      function chkType() {\n        if (!element.tagName) {\n          throw new TypeError('Object is not a valid DOM element')\n        } else if ('IFRAME' !== element.tagName.toUpperCase()) {\n          throw new TypeError(\n            'Expected <IFRAME> tag, found <' + element.tagName + '>'\n          )\n        }\n      }\n\n      if (element) {\n        chkType();\n        setupIFrame(element, options);\n        iFrames.push(element);\n      }\n    }\n\n    function warnDeprecatedOptions(options) {\n      if (options && options.enablePublicMethods) {\n        warn(\n          'enablePublicMethods option has been removed, public methods are now always available in the iFrame'\n        );\n      }\n    }\n\n    var iFrames;\n\n    setupRequestAnimationFrame();\n    setupEventListeners();\n\n    return function iFrameResizeF(options, target) {\n      iFrames = []; // Only return iFrames past in on this call\n\n      warnDeprecatedOptions(options);\n\n      switch (typeof target) {\n        case 'undefined':\n        case 'string':\n          Array.prototype.forEach.call(\n            document.querySelectorAll(target || 'iframe'),\n            init.bind(undefined$1, options)\n          );\n          break\n\n        case 'object':\n          init(options, target);\n          break\n\n        default:\n          throw new TypeError('Unexpected data type (' + typeof target + ')')\n      }\n\n      return iFrames\n    }\n  }\n\n  function createJQueryPublicMethod($) {\n    if (!$.fn) {\n      info('', 'Unable to bind to jQuery, it is not fully loaded.');\n    } else if (!$.fn.iFrameResize) {\n      $.fn.iFrameResize = function $iFrameResizeF(options) {\n        function init(index, element) {\n          setupIFrame(element, options);\n        }\n\n        return this.filter('iframe').each(init).end()\n      };\n    }\n  }\n\n  if (window.jQuery) {\n    createJQueryPublicMethod(window.jQuery);\n  }\n\n  if (typeof undefined$1 === 'function' && undefined$1.amd) {\n    undefined$1([], factory);\n  } else {\n    // Node for browserfy\n    module.exports = factory();\n  }\n  window.iFrameResize = window.iFrameResize || factory();\n})();\n});\n\n/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar __DEV__ = \"development\" !== 'production';\n\nvar warning = function() {};\n\nif (__DEV__) {\n  var printWarning = function printWarning(format, args) {\n    var len = arguments.length;\n    args = new Array(len > 1 ? len - 1 : 0);\n    for (var key = 1; key < len; key++) {\n      args[key - 1] = arguments[key];\n    }\n    var argIndex = 0;\n    var message = 'Warning: ' +\n      format.replace(/%s/g, function() {\n        return args[argIndex++];\n      });\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  };\n\n  warning = function(condition, format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    if (format === undefined) {\n      throw new Error(\n          '`warning(condition, format, ...args)` requires a warning ' +\n          'message argument'\n      );\n    }\n    if (!condition) {\n      printWarning.apply(null, [format].concat(args));\n    }\n  };\n}\n\nvar warning_1 = warning;\n\nvar filterIframeAttribs = (function (props) {\n  var autoResize = props.autoResize,\n      bodyBackground = props.bodyBackground,\n      bodyMargin = props.bodyMargin,\n      bodyPadding = props.bodyPadding,\n      checkOrigin = props.checkOrigin,\n      inPageLinks = props.inPageLinks,\n      heightCalculationMethod = props.heightCalculationMethod,\n      interval = props.interval,\n      log = props.log,\n      maxHeight = props.maxHeight,\n      maxWidth = props.maxWidth,\n      minHeight = props.minHeight,\n      minWidth = props.minWidth,\n      resizeFrom = props.resizeFrom,\n      scrolling = props.scrolling,\n      sizeHeight = props.sizeHeight,\n      sizeWidth = props.sizeWidth,\n      warningTimeout = props.warningTimeout,\n      tolerance = props.tolerance,\n      widthCalculationMethod = props.widthCalculationMethod,\n      onClosed = props.onClosed,\n      onInit = props.onInit,\n      onMessage = props.onMessage,\n      onMouseEnter = props.onMouseEnter,\n      onMouseLeave = props.onMouseLeave,\n      onResized = props.onResized,\n      iframeProps = _objectWithoutPropertiesLoose(props, [\"autoResize\", \"bodyBackground\", \"bodyMargin\", \"bodyPadding\", \"checkOrigin\", \"inPageLinks\", \"heightCalculationMethod\", \"interval\", \"log\", \"maxHeight\", \"maxWidth\", \"minHeight\", \"minWidth\", \"resizeFrom\", \"scrolling\", \"sizeHeight\", \"sizeWidth\", \"warningTimeout\", \"tolerance\", \"widthCalculationMethod\", \"onClosed\", \"onInit\", \"onMessage\", \"onMouseEnter\", \"onMouseLeave\", \"onResized\"]);\n\n  return iframeProps;\n});\n\nvar IframeResizer = function IframeResizer(props) {\n  var title = props.title,\n      forwardRef = props.forwardRef,\n      rest = _objectWithoutPropertiesLoose(props, [\"title\", \"forwardRef\"]);\n\n  var iframeProps = filterIframeAttribs(rest);\n  var iframeRef = React.useRef(null);\n\n  var onClose = function onClose() {\n    warning_1(!iframeRef.current, \"[iframeSizerReact][\" + (iframeRef && iframeRef.current && iframeRef.current.id) + \"] Close event ignored, to remove the iframe update your React component\");\n    return !iframeRef.current;\n  }; // This hook is only run once, as once iframeResizer is bound, it will\n  // deal with changes to the element and does not need recalling\n\n\n  React.useEffect(function () {\n    var iframe = iframeRef.current;\n    iframeResizer(_extends({}, rest, {\n      onClose: onClose\n    }), iframe);\n    return function () {\n      return iframe.iFrameResizer && iframe.iFrameResizer.removeListeners();\n    };\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  React.useImperativeHandle(forwardRef, function () {\n    return {\n      resize: function resize() {\n        return iframeRef.current.iFrameResizer.resize();\n      },\n      moveToAnchor: function moveToAnchor(anchor) {\n        return iframeRef.current.iFrameResizer.moveToAnchor(anchor);\n      },\n      sendMessage: function sendMessage(message, targetOrigin) {\n        iframeRef.current.iFrameResizer.sendMessage(message, targetOrigin);\n      }\n    };\n  });\n  return /*#__PURE__*/React__default['default'].createElement(\"iframe\", _extends({\n    title: title\n  }, iframeProps, {\n    ref: iframeRef\n  }));\n};\n\nIframeResizer.defaultProps = {\n  title: 'iframe'\n};\nIframeResizer.propTypes = {\n  title: PropTypes__default['default'].string\n};\n\nmodule.exports = IframeResizer;\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvaWZyYW1lLXJlc2l6ZXItcmVhY3QvZGlzdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiQUFBYTs7QUFFYixnQkFBZ0IsbUJBQU8sQ0FBQyw0REFBWTtBQUNwQyxZQUFZLG1CQUFPLENBQUMsd0dBQU87O0FBRTNCLHFDQUFxQyw0REFBNEQ7O0FBRWpHO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGNBQWMsdUJBQXVCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxtQkFBbUIsYUFBYTtBQUNoQzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLDhCQUE4QjtBQUM5Qiw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBLE9BQU87QUFDUCxrQ0FBa0M7QUFDbEMsa0NBQWtDO0FBQ2xDLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQiw4Q0FBOEM7QUFDOUQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUJBQWlCLHdCQUF3QjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQzs7QUFFMUM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSx5QkFBeUI7O0FBRXpCOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGNBQWMsWUFBWTtBQUMxQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0JBQXNCO0FBQ3RCOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNCQUFzQixtREFBbUQ7QUFDekU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrRkFBa0Y7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7O0FBRUw7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7O0FBRXBCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxjQUFjLGFBQW9COztBQUVsQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixXQUFXO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixXQUFXO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7O0FBR0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHLE9BQU87O0FBRVY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGVsbG8tbmVhci8uL25vZGVfbW9kdWxlcy9pZnJhbWUtcmVzaXplci1yZWFjdC9kaXN0L2luZGV4LmpzP2JkZjQiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgUHJvcFR5cGVzID0gcmVxdWlyZSgncHJvcC10eXBlcycpO1xudmFyIFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BEZWZhdWx0TGVnYWN5IChlKSB7IHJldHVybiBlICYmIHR5cGVvZiBlID09PSAnb2JqZWN0JyAmJiAnZGVmYXVsdCcgaW4gZSA/IGUgOiB7ICdkZWZhdWx0JzogZSB9OyB9XG5cbnZhciBQcm9wVHlwZXNfX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX2ludGVyb3BEZWZhdWx0TGVnYWN5KFByb3BUeXBlcyk7XG52YXIgUmVhY3RfX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX2ludGVyb3BEZWZhdWx0TGVnYWN5KFJlYWN0KTtcblxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG5cbiAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcblxuICByZXR1cm4gX2V4dGVuZHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2Uoc291cmNlLCBleGNsdWRlZCkge1xuICBpZiAoc291cmNlID09IG51bGwpIHJldHVybiB7fTtcbiAgdmFyIHRhcmdldCA9IHt9O1xuICB2YXIgc291cmNlS2V5cyA9IE9iamVjdC5rZXlzKHNvdXJjZSk7XG4gIHZhciBrZXksIGk7XG5cbiAgZm9yIChpID0gMDsgaSA8IHNvdXJjZUtleXMubGVuZ3RoOyBpKyspIHtcbiAgICBrZXkgPSBzb3VyY2VLZXlzW2ldO1xuICAgIGlmIChleGNsdWRlZC5pbmRleE9mKGtleSkgPj0gMCkgY29udGludWU7XG4gICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgfVxuXG4gIHJldHVybiB0YXJnZXQ7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZuLCBtb2R1bGUpIHtcblx0cmV0dXJuIG1vZHVsZSA9IHsgZXhwb3J0czoge30gfSwgZm4obW9kdWxlLCBtb2R1bGUuZXhwb3J0cyksIG1vZHVsZS5leHBvcnRzO1xufVxuXG52YXIgaWZyYW1lUmVzaXplciA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHtcbihmdW5jdGlvbiAodW5kZWZpbmVkJDEpIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm4gLy8gZG9uJ3QgcnVuIGZvciBzZXJ2ZXIgc2lkZSByZW5kZXJcblxuICB2YXIgY291bnQgPSAwLFxuICAgIGxvZ0VuYWJsZWQgPSBmYWxzZSxcbiAgICBoaWRkZW5DaGVja0VuYWJsZWQgPSBmYWxzZSxcbiAgICBtc2dIZWFkZXIgPSAnbWVzc2FnZScsXG4gICAgbXNnSGVhZGVyTGVuID0gbXNnSGVhZGVyLmxlbmd0aCxcbiAgICBtc2dJZCA9ICdbaUZyYW1lU2l6ZXJdJywgLy8gTXVzdCBtYXRjaCBpZnJhbWUgbXNnIElEXG4gICAgbXNnSWRMZW4gPSBtc2dJZC5sZW5ndGgsXG4gICAgcGFnZVBvc2l0aW9uID0gbnVsbCxcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lLFxuICAgIHJlc2V0UmVxdWlyZWRNZXRob2RzID0ge1xuICAgICAgbWF4OiAxLFxuICAgICAgc2Nyb2xsOiAxLFxuICAgICAgYm9keVNjcm9sbDogMSxcbiAgICAgIGRvY3VtZW50RWxlbWVudFNjcm9sbDogMVxuICAgIH0sXG4gICAgc2V0dGluZ3MgPSB7fSxcbiAgICB0aW1lciA9IG51bGwsXG4gICAgZGVmYXVsdHMgPSB7XG4gICAgICBhdXRvUmVzaXplOiB0cnVlLFxuICAgICAgYm9keUJhY2tncm91bmQ6IG51bGwsXG4gICAgICBib2R5TWFyZ2luOiBudWxsLFxuICAgICAgYm9keU1hcmdpblYxOiA4LFxuICAgICAgYm9keVBhZGRpbmc6IG51bGwsXG4gICAgICBjaGVja09yaWdpbjogdHJ1ZSxcbiAgICAgIGluUGFnZUxpbmtzOiBmYWxzZSxcbiAgICAgIGVuYWJsZVB1YmxpY01ldGhvZHM6IHRydWUsXG4gICAgICBoZWlnaHRDYWxjdWxhdGlvbk1ldGhvZDogJ2JvZHlPZmZzZXQnLFxuICAgICAgaWQ6ICdpRnJhbWVSZXNpemVyJyxcbiAgICAgIGludGVydmFsOiAzMixcbiAgICAgIGxvZzogZmFsc2UsXG4gICAgICBtYXhIZWlnaHQ6IEluZmluaXR5LFxuICAgICAgbWF4V2lkdGg6IEluZmluaXR5LFxuICAgICAgbWluSGVpZ2h0OiAwLFxuICAgICAgbWluV2lkdGg6IDAsXG4gICAgICByZXNpemVGcm9tOiAncGFyZW50JyxcbiAgICAgIHNjcm9sbGluZzogZmFsc2UsXG4gICAgICBzaXplSGVpZ2h0OiB0cnVlLFxuICAgICAgc2l6ZVdpZHRoOiBmYWxzZSxcbiAgICAgIHdhcm5pbmdUaW1lb3V0OiA1MDAwLFxuICAgICAgdG9sZXJhbmNlOiAwLFxuICAgICAgd2lkdGhDYWxjdWxhdGlvbk1ldGhvZDogJ3Njcm9sbCcsXG4gICAgICBvbkNsb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9LFxuICAgICAgb25DbG9zZWQ6IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgb25Jbml0OiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgIG9uTWVzc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB3YXJuKCdvbk1lc3NhZ2UgZnVuY3Rpb24gbm90IGRlZmluZWQnKTtcbiAgICAgIH0sXG4gICAgICBvbk1vdXNlRW50ZXI6IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgb25Nb3VzZUxlYXZlOiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgIG9uUmVzaXplZDogZnVuY3Rpb24gKCkge30sXG4gICAgICBvblNjcm9sbDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfVxuICAgIH07XG5cbiAgZnVuY3Rpb24gZ2V0TXV0YXRpb25PYnNlcnZlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHxcbiAgICAgIHdpbmRvdy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyIHx8XG4gICAgICB3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlclxuICAgIClcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIoZWwsIGV2dCwgZnVuYykge1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZ0LCBmdW5jLCBmYWxzZSk7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVFdmVudExpc3RlbmVyKGVsLCBldnQsIGZ1bmMpIHtcbiAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKGV2dCwgZnVuYywgZmFsc2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0dXBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKSB7XG4gICAgdmFyIHZlbmRvcnMgPSBbJ21veicsICd3ZWJraXQnLCAnbycsICdtcyddO1xuICAgIHZhciB4O1xuXG4gICAgLy8gUmVtb3ZlIHZlbmRvciBwcmVmaXhpbmcgaWYgcHJlZml4ZWQgYW5kIGJyZWFrIGVhcmx5IGlmIG5vdFxuICAgIGZvciAoeCA9IDA7IHggPCB2ZW5kb3JzLmxlbmd0aCAmJiAhcmVxdWVzdEFuaW1hdGlvbkZyYW1lOyB4ICs9IDEpIHtcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvd1t2ZW5kb3JzW3hdICsgJ1JlcXVlc3RBbmltYXRpb25GcmFtZSddO1xuICAgIH1cblxuICAgIGlmICghcmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XG4gICAgICBsb2coJ3NldHVwJywgJ1JlcXVlc3RBbmltYXRpb25GcmFtZSBub3Qgc3VwcG9ydGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZpcmVmb3ggZXh0ZW5zaW9uIGNvbnRlbnQtc2NyaXB0cyBoYXZlIGEgZ2xvYmFsVGhpcyBvYmplY3QgdGhhdCBpcyBub3QgdGhlIHNhbWUgYXMgd2luZG93LlxuICAgICAgLy8gQmluZGluZyBgcmVxdWVzdEFuaW1hdGlvbkZyYW1lYCB0byB3aW5kb3cgYWxsb3dzIHRoZSBmdW5jdGlvbiB0byB3b3JrIGFuZCBwcmV2ZW50cyBlcnJvcnNcbiAgICAgIC8vIGJlaW5nIHRocm93biB3aGVuIHJ1biBpbiB0aGF0IGNvbnRleHQsIGFuZCBzaG91bGQgYmUgYSBuby1vcCBpbiBldmVyeSBvdGhlciBjb250ZXh0LlxuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lLmJpbmQod2luZG93KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRNeUlEKGlmcmFtZUlkKSB7XG4gICAgdmFyIHJldFN0ciA9ICdIb3N0IHBhZ2U6ICcgKyBpZnJhbWVJZDtcblxuICAgIGlmICh3aW5kb3cudG9wICE9PSB3aW5kb3cuc2VsZikge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHVuaWNvcm4vcHJlZmVyLXRlcm5hcnlcbiAgICAgIGlmICh3aW5kb3cucGFyZW50SUZyYW1lICYmIHdpbmRvdy5wYXJlbnRJRnJhbWUuZ2V0SWQpIHtcbiAgICAgICAgcmV0U3RyID0gd2luZG93LnBhcmVudElGcmFtZS5nZXRJZCgpICsgJzogJyArIGlmcmFtZUlkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0U3RyID0gJ05lc3RlZCBob3N0IHBhZ2U6ICcgKyBpZnJhbWVJZDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmV0U3RyXG4gIH1cblxuICBmdW5jdGlvbiBmb3JtYXRMb2dIZWFkZXIoaWZyYW1lSWQpIHtcbiAgICByZXR1cm4gbXNnSWQgKyAnWycgKyBnZXRNeUlEKGlmcmFtZUlkKSArICddJ1xuICB9XG5cbiAgZnVuY3Rpb24gaXNMb2dFbmFibGVkKGlmcmFtZUlkKSB7XG4gICAgcmV0dXJuIHNldHRpbmdzW2lmcmFtZUlkXSA/IHNldHRpbmdzW2lmcmFtZUlkXS5sb2cgOiBsb2dFbmFibGVkXG4gIH1cblxuICBmdW5jdGlvbiBsb2coaWZyYW1lSWQsIG1zZykge1xuICAgIG91dHB1dCgnbG9nJywgaWZyYW1lSWQsIG1zZywgaXNMb2dFbmFibGVkKGlmcmFtZUlkKSk7XG4gIH1cblxuICBmdW5jdGlvbiBpbmZvKGlmcmFtZUlkLCBtc2cpIHtcbiAgICBvdXRwdXQoJ2luZm8nLCBpZnJhbWVJZCwgbXNnLCBpc0xvZ0VuYWJsZWQoaWZyYW1lSWQpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHdhcm4oaWZyYW1lSWQsIG1zZykge1xuICAgIG91dHB1dCgnd2FybicsIGlmcmFtZUlkLCBtc2csIHRydWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gb3V0cHV0KHR5cGUsIGlmcmFtZUlkLCBtc2csIGVuYWJsZWQpIHtcbiAgICBpZiAodHJ1ZSA9PT0gZW5hYmxlZCAmJiAnb2JqZWN0JyA9PT0gdHlwZW9mIHdpbmRvdy5jb25zb2xlKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZVt0eXBlXShmb3JtYXRMb2dIZWFkZXIoaWZyYW1lSWQpLCBtc2cpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGlGcmFtZUxpc3RlbmVyKGV2ZW50KSB7XG4gICAgZnVuY3Rpb24gcmVzaXplSUZyYW1lKCkge1xuICAgICAgZnVuY3Rpb24gcmVzaXplKCkge1xuICAgICAgICBzZXRTaXplKG1lc3NhZ2VEYXRhKTtcbiAgICAgICAgc2V0UGFnZVBvc2l0aW9uKGlmcmFtZUlkKTtcbiAgICAgICAgb24oJ29uUmVzaXplZCcsIG1lc3NhZ2VEYXRhKTtcbiAgICAgIH1cblxuICAgICAgZW5zdXJlSW5SYW5nZSgnSGVpZ2h0Jyk7XG4gICAgICBlbnN1cmVJblJhbmdlKCdXaWR0aCcpO1xuXG4gICAgICBzeW5jUmVzaXplKHJlc2l6ZSwgbWVzc2FnZURhdGEsICdpbml0Jyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJvY2Vzc01zZygpIHtcbiAgICAgIHZhciBkYXRhID0gbXNnLnN1YnN0cihtc2dJZExlbikuc3BsaXQoJzonKTtcbiAgICAgIHZhciBoZWlnaHQgPSBkYXRhWzFdID8gcGFyc2VJbnQoZGF0YVsxXSwgMTApIDogMDtcbiAgICAgIHZhciBpZnJhbWUgPSBzZXR0aW5nc1tkYXRhWzBdXSAmJiBzZXR0aW5nc1tkYXRhWzBdXS5pZnJhbWU7XG4gICAgICB2YXIgY29tcFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShpZnJhbWUpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZnJhbWU6IGlmcmFtZSxcbiAgICAgICAgaWQ6IGRhdGFbMF0sXG4gICAgICAgIGhlaWdodDogaGVpZ2h0ICsgZ2V0UGFkZGluZ0VuZHMoY29tcFN0eWxlKSArIGdldEJvcmRlckVuZHMoY29tcFN0eWxlKSxcbiAgICAgICAgd2lkdGg6IGRhdGFbMl0sXG4gICAgICAgIHR5cGU6IGRhdGFbM11cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQYWRkaW5nRW5kcyhjb21wU3R5bGUpIHtcbiAgICAgIGlmIChjb21wU3R5bGUuYm94U2l6aW5nICE9PSAnYm9yZGVyLWJveCcpIHtcbiAgICAgICAgcmV0dXJuIDBcbiAgICAgIH1cbiAgICAgIHZhciB0b3AgPSBjb21wU3R5bGUucGFkZGluZ1RvcCA/IHBhcnNlSW50KGNvbXBTdHlsZS5wYWRkaW5nVG9wLCAxMCkgOiAwO1xuICAgICAgdmFyIGJvdCA9IGNvbXBTdHlsZS5wYWRkaW5nQm90dG9tXG4gICAgICAgID8gcGFyc2VJbnQoY29tcFN0eWxlLnBhZGRpbmdCb3R0b20sIDEwKVxuICAgICAgICA6IDA7XG4gICAgICByZXR1cm4gdG9wICsgYm90XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0Qm9yZGVyRW5kcyhjb21wU3R5bGUpIHtcbiAgICAgIGlmIChjb21wU3R5bGUuYm94U2l6aW5nICE9PSAnYm9yZGVyLWJveCcpIHtcbiAgICAgICAgcmV0dXJuIDBcbiAgICAgIH1cbiAgICAgIHZhciB0b3AgPSBjb21wU3R5bGUuYm9yZGVyVG9wV2lkdGhcbiAgICAgICAgPyBwYXJzZUludChjb21wU3R5bGUuYm9yZGVyVG9wV2lkdGgsIDEwKVxuICAgICAgICA6IDA7XG4gICAgICB2YXIgYm90ID0gY29tcFN0eWxlLmJvcmRlckJvdHRvbVdpZHRoXG4gICAgICAgID8gcGFyc2VJbnQoY29tcFN0eWxlLmJvcmRlckJvdHRvbVdpZHRoLCAxMClcbiAgICAgICAgOiAwO1xuICAgICAgcmV0dXJuIHRvcCArIGJvdFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVuc3VyZUluUmFuZ2UoRGltZW5zaW9uKSB7XG4gICAgICB2YXIgbWF4ID0gTnVtYmVyKHNldHRpbmdzW2lmcmFtZUlkXVsnbWF4JyArIERpbWVuc2lvbl0pLFxuICAgICAgICBtaW4gPSBOdW1iZXIoc2V0dGluZ3NbaWZyYW1lSWRdWydtaW4nICsgRGltZW5zaW9uXSksXG4gICAgICAgIGRpbWVuc2lvbiA9IERpbWVuc2lvbi50b0xvd2VyQ2FzZSgpLFxuICAgICAgICBzaXplID0gTnVtYmVyKG1lc3NhZ2VEYXRhW2RpbWVuc2lvbl0pO1xuXG4gICAgICBsb2coaWZyYW1lSWQsICdDaGVja2luZyAnICsgZGltZW5zaW9uICsgJyBpcyBpbiByYW5nZSAnICsgbWluICsgJy0nICsgbWF4KTtcblxuICAgICAgaWYgKHNpemUgPCBtaW4pIHtcbiAgICAgICAgc2l6ZSA9IG1pbjtcbiAgICAgICAgbG9nKGlmcmFtZUlkLCAnU2V0ICcgKyBkaW1lbnNpb24gKyAnIHRvIG1pbiB2YWx1ZScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2l6ZSA+IG1heCkge1xuICAgICAgICBzaXplID0gbWF4O1xuICAgICAgICBsb2coaWZyYW1lSWQsICdTZXQgJyArIGRpbWVuc2lvbiArICcgdG8gbWF4IHZhbHVlJyk7XG4gICAgICB9XG5cbiAgICAgIG1lc3NhZ2VEYXRhW2RpbWVuc2lvbl0gPSAnJyArIHNpemU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNNZXNzYWdlRnJvbUlGcmFtZSgpIHtcbiAgICAgIGZ1bmN0aW9uIGNoZWNrQWxsb3dlZE9yaWdpbigpIHtcbiAgICAgICAgZnVuY3Rpb24gY2hlY2tMaXN0KCkge1xuICAgICAgICAgIHZhciBpID0gMCxcbiAgICAgICAgICAgIHJldENvZGUgPSBmYWxzZTtcblxuICAgICAgICAgIGxvZyhcbiAgICAgICAgICAgIGlmcmFtZUlkLFxuICAgICAgICAgICAgJ0NoZWNraW5nIGNvbm5lY3Rpb24gaXMgZnJvbSBhbGxvd2VkIGxpc3Qgb2Ygb3JpZ2luczogJyArXG4gICAgICAgICAgICAgIGNoZWNrT3JpZ2luXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIGZvciAoOyBpIDwgY2hlY2tPcmlnaW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjaGVja09yaWdpbltpXSA9PT0gb3JpZ2luKSB7XG4gICAgICAgICAgICAgIHJldENvZGUgPSB0cnVlO1xuICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcmV0Q29kZVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2hlY2tTaW5nbGUoKSB7XG4gICAgICAgICAgdmFyIHJlbW90ZUhvc3QgPSBzZXR0aW5nc1tpZnJhbWVJZF0gJiYgc2V0dGluZ3NbaWZyYW1lSWRdLnJlbW90ZUhvc3Q7XG4gICAgICAgICAgbG9nKGlmcmFtZUlkLCAnQ2hlY2tpbmcgY29ubmVjdGlvbiBpcyBmcm9tOiAnICsgcmVtb3RlSG9zdCk7XG4gICAgICAgICAgcmV0dXJuIG9yaWdpbiA9PT0gcmVtb3RlSG9zdFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNoZWNrT3JpZ2luLmNvbnN0cnVjdG9yID09PSBBcnJheSA/IGNoZWNrTGlzdCgpIDogY2hlY2tTaW5nbGUoKVxuICAgICAgfVxuXG4gICAgICB2YXIgb3JpZ2luID0gZXZlbnQub3JpZ2luLFxuICAgICAgICBjaGVja09yaWdpbiA9IHNldHRpbmdzW2lmcmFtZUlkXSAmJiBzZXR0aW5nc1tpZnJhbWVJZF0uY2hlY2tPcmlnaW47XG5cbiAgICAgIGlmIChjaGVja09yaWdpbiAmJiAnJyArIG9yaWdpbiAhPT0gJ251bGwnICYmICFjaGVja0FsbG93ZWRPcmlnaW4oKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgJ1VuZXhwZWN0ZWQgbWVzc2FnZSByZWNlaXZlZCBmcm9tOiAnICtcbiAgICAgICAgICAgIG9yaWdpbiArXG4gICAgICAgICAgICAnIGZvciAnICtcbiAgICAgICAgICAgIG1lc3NhZ2VEYXRhLmlmcmFtZS5pZCArXG4gICAgICAgICAgICAnLiBNZXNzYWdlIHdhczogJyArXG4gICAgICAgICAgICBldmVudC5kYXRhICtcbiAgICAgICAgICAgICcuIFRoaXMgZXJyb3IgY2FuIGJlIGRpc2FibGVkIGJ5IHNldHRpbmcgdGhlIGNoZWNrT3JpZ2luOiBmYWxzZSBvcHRpb24gb3IgYnkgcHJvdmlkaW5nIG9mIGFycmF5IG9mIHRydXN0ZWQgZG9tYWlucy4nXG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc01lc3NhZ2VGb3JVcygpIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIG1zZ0lkID09PSAoJycgKyBtc2cpLnN1YnN0cigwLCBtc2dJZExlbikgJiZcbiAgICAgICAgbXNnLnN1YnN0cihtc2dJZExlbikuc3BsaXQoJzonKVswXSBpbiBzZXR0aW5nc1xuICAgICAgKSAvLyAnJytQcm90ZWN0cyBhZ2FpbnN0IG5vbi1zdHJpbmcgbXNnXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNNZXNzYWdlRnJvbU1ldGFQYXJlbnQoKSB7XG4gICAgICAvLyBUZXN0IGlmIHRoaXMgbWVzc2FnZSBpcyBmcm9tIGEgcGFyZW50IGFib3ZlIHVzLiBUaGlzIGlzIGFuIHVnbHkgdGVzdCwgaG93ZXZlciwgdXBkYXRpbmdcbiAgICAgIC8vIHRoZSBtZXNzYWdlIGZvcm1hdCB3b3VsZCBicmVhayBiYWNrd2FyZHMgY29tcGF0aWJpdHkuXG4gICAgICB2YXIgcmV0Q29kZSA9IG1lc3NhZ2VEYXRhLnR5cGUgaW4geyB0cnVlOiAxLCBmYWxzZTogMSwgdW5kZWZpbmVkOiAxIH07XG5cbiAgICAgIGlmIChyZXRDb2RlKSB7XG4gICAgICAgIGxvZyhpZnJhbWVJZCwgJ0lnbm9yaW5nIGluaXQgbWVzc2FnZSBmcm9tIG1ldGEgcGFyZW50IHBhZ2UnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJldENvZGVcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRNc2dCb2R5KG9mZnNldCkge1xuICAgICAgcmV0dXJuIG1zZy5zdWJzdHIobXNnLmluZGV4T2YoJzonKSArIG1zZ0hlYWRlckxlbiArIG9mZnNldClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmb3J3YXJkTXNnRnJvbUlGcmFtZShtc2dCb2R5KSB7XG4gICAgICBsb2coXG4gICAgICAgIGlmcmFtZUlkLFxuICAgICAgICAnb25NZXNzYWdlIHBhc3NlZDoge2lmcmFtZTogJyArXG4gICAgICAgICAgbWVzc2FnZURhdGEuaWZyYW1lLmlkICtcbiAgICAgICAgICAnLCBtZXNzYWdlOiAnICtcbiAgICAgICAgICBtc2dCb2R5ICtcbiAgICAgICAgICAnfSdcbiAgICAgICk7XG5cbiAgICAgIG9uKCdvbk1lc3NhZ2UnLCB7XG4gICAgICAgIGlmcmFtZTogbWVzc2FnZURhdGEuaWZyYW1lLFxuICAgICAgICBtZXNzYWdlOiBKU09OLnBhcnNlKG1zZ0JvZHkpXG4gICAgICB9KTtcblxuICAgICAgbG9nKGlmcmFtZUlkLCAnLS0nKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRQYWdlSW5mbygpIHtcbiAgICAgIHZhciBib2R5UG9zaXRpb24gPSBkb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICBpRnJhbWVQb3NpdGlvbiA9IG1lc3NhZ2VEYXRhLmlmcmFtZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaWZyYW1lSGVpZ2h0OiBpRnJhbWVQb3NpdGlvbi5oZWlnaHQsXG4gICAgICAgIGlmcmFtZVdpZHRoOiBpRnJhbWVQb3NpdGlvbi53aWR0aCxcbiAgICAgICAgY2xpZW50SGVpZ2h0OiBNYXRoLm1heChcbiAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0LFxuICAgICAgICAgIHdpbmRvdy5pbm5lckhlaWdodCB8fCAwXG4gICAgICAgICksXG4gICAgICAgIGNsaWVudFdpZHRoOiBNYXRoLm1heChcbiAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsXG4gICAgICAgICAgd2luZG93LmlubmVyV2lkdGggfHwgMFxuICAgICAgICApLFxuICAgICAgICBvZmZzZXRUb3A6IHBhcnNlSW50KGlGcmFtZVBvc2l0aW9uLnRvcCAtIGJvZHlQb3NpdGlvbi50b3AsIDEwKSxcbiAgICAgICAgb2Zmc2V0TGVmdDogcGFyc2VJbnQoaUZyYW1lUG9zaXRpb24ubGVmdCAtIGJvZHlQb3NpdGlvbi5sZWZ0LCAxMCksXG4gICAgICAgIHNjcm9sbFRvcDogd2luZG93LnBhZ2VZT2Zmc2V0LFxuICAgICAgICBzY3JvbGxMZWZ0OiB3aW5kb3cucGFnZVhPZmZzZXQsXG4gICAgICAgIGRvY3VtZW50SGVpZ2h0OiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0LFxuICAgICAgICBkb2N1bWVudFdpZHRoOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsXG4gICAgICAgIHdpbmRvd0hlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICB3aW5kb3dXaWR0aDogd2luZG93LmlubmVyV2lkdGhcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VuZFBhZ2VJbmZvVG9JZnJhbWUoaWZyYW1lLCBpZnJhbWVJZCkge1xuICAgICAgZnVuY3Rpb24gZGVib3VuY2VkVHJpZ2dlcigpIHtcbiAgICAgICAgdHJpZ2dlcignU2VuZCBQYWdlIEluZm8nLCAncGFnZUluZm86JyArIGdldFBhZ2VJbmZvKCksIGlmcmFtZSwgaWZyYW1lSWQpO1xuICAgICAgfVxuICAgICAgZGVib3VuY2VGcmFtZUV2ZW50cyhkZWJvdW5jZWRUcmlnZ2VyLCAzMiwgaWZyYW1lSWQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0YXJ0UGFnZUluZm9Nb25pdG9yKCkge1xuICAgICAgZnVuY3Rpb24gc2V0TGlzdGVuZXIodHlwZSwgZnVuYykge1xuICAgICAgICBmdW5jdGlvbiBzZW5kUGFnZUluZm8oKSB7XG4gICAgICAgICAgaWYgKHNldHRpbmdzW2lkXSkge1xuICAgICAgICAgICAgc2VuZFBhZ2VJbmZvVG9JZnJhbWUoc2V0dGluZ3NbaWRdLmlmcmFtZSwgaWQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5bJ3Njcm9sbCcsICdyZXNpemUnXS5mb3JFYWNoKGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICBsb2coaWQsIHR5cGUgKyBldnQgKyAnIGxpc3RlbmVyIGZvciBzZW5kUGFnZUluZm8nKTtcbiAgICAgICAgICBmdW5jKHdpbmRvdywgZXZ0LCBzZW5kUGFnZUluZm8pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgc2V0TGlzdGVuZXIoJ1JlbW92ZSAnLCByZW1vdmVFdmVudExpc3RlbmVyKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIHNldExpc3RlbmVyKCdBZGQgJywgYWRkRXZlbnRMaXN0ZW5lcik7XG4gICAgICB9XG5cbiAgICAgIHZhciBpZCA9IGlmcmFtZUlkOyAvLyBDcmVhdGUgbG9jYWxseSBzY29wZWQgY29weSBvZiBpRnJhbWUgSURcblxuICAgICAgc3RhcnQoKTtcblxuICAgICAgaWYgKHNldHRpbmdzW2lkXSkge1xuICAgICAgICBzZXR0aW5nc1tpZF0uc3RvcFBhZ2VJbmZvID0gc3RvcDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdG9wUGFnZUluZm9Nb25pdG9yKCkge1xuICAgICAgaWYgKHNldHRpbmdzW2lmcmFtZUlkXSAmJiBzZXR0aW5nc1tpZnJhbWVJZF0uc3RvcFBhZ2VJbmZvKSB7XG4gICAgICAgIHNldHRpbmdzW2lmcmFtZUlkXS5zdG9wUGFnZUluZm8oKTtcbiAgICAgICAgZGVsZXRlIHNldHRpbmdzW2lmcmFtZUlkXS5zdG9wUGFnZUluZm87XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hlY2tJRnJhbWVFeGlzdHMoKSB7XG4gICAgICB2YXIgcmV0Qm9vbCA9IHRydWU7XG5cbiAgICAgIGlmIChudWxsID09PSBtZXNzYWdlRGF0YS5pZnJhbWUpIHtcbiAgICAgICAgd2FybihpZnJhbWVJZCwgJ0lGcmFtZSAoJyArIG1lc3NhZ2VEYXRhLmlkICsgJykgbm90IGZvdW5kJyk7XG4gICAgICAgIHJldEJvb2wgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXRCb29sXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0RWxlbWVudFBvc2l0aW9uKHRhcmdldCkge1xuICAgICAgdmFyIGlGcmFtZVBvc2l0aW9uID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICBnZXRQYWdlUG9zaXRpb24oaWZyYW1lSWQpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB4OiBNYXRoLmZsb29yKE51bWJlcihpRnJhbWVQb3NpdGlvbi5sZWZ0KSArIE51bWJlcihwYWdlUG9zaXRpb24ueCkpLFxuICAgICAgICB5OiBNYXRoLmZsb29yKE51bWJlcihpRnJhbWVQb3NpdGlvbi50b3ApICsgTnVtYmVyKHBhZ2VQb3NpdGlvbi55KSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzY3JvbGxSZXF1ZXN0RnJvbUNoaWxkKGFkZE9mZnNldCkge1xuICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gLy8gTm90IHRlc3RhYmxlIGluIEthcm1hXG4gICAgICBmdW5jdGlvbiByZXBvc2l0aW9uKCkge1xuICAgICAgICBwYWdlUG9zaXRpb24gPSBuZXdQb3NpdGlvbjtcbiAgICAgICAgc2Nyb2xsVG8oKTtcbiAgICAgICAgbG9nKGlmcmFtZUlkLCAnLS0nKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY2FsY09mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB4OiBOdW1iZXIobWVzc2FnZURhdGEud2lkdGgpICsgb2Zmc2V0LngsXG4gICAgICAgICAgeTogTnVtYmVyKG1lc3NhZ2VEYXRhLmhlaWdodCkgKyBvZmZzZXQueVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHNjcm9sbFBhcmVudCgpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5wYXJlbnRJRnJhbWUpIHtcbiAgICAgICAgICB3aW5kb3cucGFyZW50SUZyYW1lWydzY3JvbGxUbycgKyAoYWRkT2Zmc2V0ID8gJ09mZnNldCcgOiAnJyldKFxuICAgICAgICAgICAgbmV3UG9zaXRpb24ueCxcbiAgICAgICAgICAgIG5ld1Bvc2l0aW9uLnlcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdhcm4oXG4gICAgICAgICAgICBpZnJhbWVJZCxcbiAgICAgICAgICAgICdVbmFibGUgdG8gc2Nyb2xsIHRvIHJlcXVlc3RlZCBwb3NpdGlvbiwgd2luZG93LnBhcmVudElGcmFtZSBub3QgZm91bmQnXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB2YXIgb2Zmc2V0ID0gYWRkT2Zmc2V0XG4gICAgICAgICAgPyBnZXRFbGVtZW50UG9zaXRpb24obWVzc2FnZURhdGEuaWZyYW1lKVxuICAgICAgICAgIDogeyB4OiAwLCB5OiAwIH0sXG4gICAgICAgIG5ld1Bvc2l0aW9uID0gY2FsY09mZnNldCgpO1xuXG4gICAgICBsb2coXG4gICAgICAgIGlmcmFtZUlkLFxuICAgICAgICAnUmVwb3NpdGlvbiByZXF1ZXN0ZWQgZnJvbSBpRnJhbWUgKG9mZnNldCB4OicgK1xuICAgICAgICAgIG9mZnNldC54ICtcbiAgICAgICAgICAnIHk6JyArXG4gICAgICAgICAgb2Zmc2V0LnkgK1xuICAgICAgICAgICcpJ1xuICAgICAgKTtcblxuICAgICAgaWYgKHdpbmRvdy50b3AgIT09IHdpbmRvdy5zZWxmKSB7XG4gICAgICAgIHNjcm9sbFBhcmVudCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVwb3NpdGlvbigpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjcm9sbFRvKCkge1xuICAgICAgaWYgKGZhbHNlICE9PSBvbignb25TY3JvbGwnLCBwYWdlUG9zaXRpb24pKSB7XG4gICAgICAgIHNldFBhZ2VQb3NpdGlvbihpZnJhbWVJZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1bnNldFBhZ2VQb3NpdGlvbigpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbmRUYXJnZXQobG9jYXRpb24pIHtcbiAgICAgIGZ1bmN0aW9uIGp1bXBUb1RhcmdldCgpIHtcbiAgICAgICAgdmFyIGp1bXBQb3NpdGlvbiA9IGdldEVsZW1lbnRQb3NpdGlvbih0YXJnZXQpO1xuXG4gICAgICAgIGxvZyhcbiAgICAgICAgICBpZnJhbWVJZCxcbiAgICAgICAgICAnTW92aW5nIHRvIGluIHBhZ2UgbGluayAoIycgK1xuICAgICAgICAgICAgaGFzaCArXG4gICAgICAgICAgICAnKSBhdCB4OiAnICtcbiAgICAgICAgICAgIGp1bXBQb3NpdGlvbi54ICtcbiAgICAgICAgICAgICcgeTogJyArXG4gICAgICAgICAgICBqdW1wUG9zaXRpb24ueVxuICAgICAgICApO1xuICAgICAgICBwYWdlUG9zaXRpb24gPSB7XG4gICAgICAgICAgeDoganVtcFBvc2l0aW9uLngsXG4gICAgICAgICAgeToganVtcFBvc2l0aW9uLnlcbiAgICAgICAgfTtcblxuICAgICAgICBzY3JvbGxUbygpO1xuICAgICAgICBsb2coaWZyYW1lSWQsICctLScpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBqdW1wVG9QYXJlbnQoKSB7XG4gICAgICAgIGlmICh3aW5kb3cucGFyZW50SUZyYW1lKSB7XG4gICAgICAgICAgd2luZG93LnBhcmVudElGcmFtZS5tb3ZlVG9BbmNob3IoaGFzaCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbG9nKFxuICAgICAgICAgICAgaWZyYW1lSWQsXG4gICAgICAgICAgICAnSW4gcGFnZSBsaW5rICMnICtcbiAgICAgICAgICAgICAgaGFzaCArXG4gICAgICAgICAgICAgICcgbm90IGZvdW5kIGFuZCB3aW5kb3cucGFyZW50SUZyYW1lIG5vdCBmb3VuZCdcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBoYXNoID0gbG9jYXRpb24uc3BsaXQoJyMnKVsxXSB8fCAnJyxcbiAgICAgICAgaGFzaERhdGEgPSBkZWNvZGVVUklDb21wb25lbnQoaGFzaCksXG4gICAgICAgIHRhcmdldCA9XG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaGFzaERhdGEpIHx8XG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoaGFzaERhdGEpWzBdO1xuXG4gICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgIGp1bXBUb1RhcmdldCgpO1xuICAgICAgfSBlbHNlIGlmICh3aW5kb3cudG9wICE9PSB3aW5kb3cuc2VsZikge1xuICAgICAgICBqdW1wVG9QYXJlbnQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZyhpZnJhbWVJZCwgJ0luIHBhZ2UgbGluayAjJyArIGhhc2ggKyAnIG5vdCBmb3VuZCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uTW91c2UoZXZlbnQpIHtcbiAgICAgIG9uKGV2ZW50LCB7XG4gICAgICAgIGlmcmFtZTogbWVzc2FnZURhdGEuaWZyYW1lLFxuICAgICAgICBzY3JlZW5YOiBtZXNzYWdlRGF0YS53aWR0aCxcbiAgICAgICAgc2NyZWVuWTogbWVzc2FnZURhdGEuaGVpZ2h0LFxuICAgICAgICB0eXBlOiBtZXNzYWdlRGF0YS50eXBlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbihmdW5jTmFtZSwgdmFsKSB7XG4gICAgICByZXR1cm4gY2hrRXZlbnQoaWZyYW1lSWQsIGZ1bmNOYW1lLCB2YWwpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWN0aW9uTXNnKCkge1xuICAgICAgaWYgKHNldHRpbmdzW2lmcmFtZUlkXSAmJiBzZXR0aW5nc1tpZnJhbWVJZF0uZmlyc3RSdW4pIGZpcnN0UnVuKCk7XG5cbiAgICAgIHN3aXRjaCAobWVzc2FnZURhdGEudHlwZSkge1xuICAgICAgICBjYXNlICdjbG9zZSc6XG4gICAgICAgICAgY2xvc2VJRnJhbWUobWVzc2FnZURhdGEuaWZyYW1lKTtcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgJ21lc3NhZ2UnOlxuICAgICAgICAgIGZvcndhcmRNc2dGcm9tSUZyYW1lKGdldE1zZ0JvZHkoNikpO1xuICAgICAgICAgIGJyZWFrXG5cbiAgICAgICAgY2FzZSAnbW91c2VlbnRlcic6XG4gICAgICAgICAgb25Nb3VzZSgnb25Nb3VzZUVudGVyJyk7XG4gICAgICAgICAgYnJlYWtcblxuICAgICAgICBjYXNlICdtb3VzZWxlYXZlJzpcbiAgICAgICAgICBvbk1vdXNlKCdvbk1vdXNlTGVhdmUnKTtcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgJ2F1dG9SZXNpemUnOlxuICAgICAgICAgIHNldHRpbmdzW2lmcmFtZUlkXS5hdXRvUmVzaXplID0gSlNPTi5wYXJzZShnZXRNc2dCb2R5KDkpKTtcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgJ3Njcm9sbFRvJzpcbiAgICAgICAgICBzY3JvbGxSZXF1ZXN0RnJvbUNoaWxkKGZhbHNlKTtcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgJ3Njcm9sbFRvT2Zmc2V0JzpcbiAgICAgICAgICBzY3JvbGxSZXF1ZXN0RnJvbUNoaWxkKHRydWUpO1xuICAgICAgICAgIGJyZWFrXG5cbiAgICAgICAgY2FzZSAncGFnZUluZm8nOlxuICAgICAgICAgIHNlbmRQYWdlSW5mb1RvSWZyYW1lKFxuICAgICAgICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdICYmIHNldHRpbmdzW2lmcmFtZUlkXS5pZnJhbWUsXG4gICAgICAgICAgICBpZnJhbWVJZFxuICAgICAgICAgICk7XG4gICAgICAgICAgc3RhcnRQYWdlSW5mb01vbml0b3IoKTtcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgJ3BhZ2VJbmZvU3RvcCc6XG4gICAgICAgICAgc3RvcFBhZ2VJbmZvTW9uaXRvcigpO1xuICAgICAgICAgIGJyZWFrXG5cbiAgICAgICAgY2FzZSAnaW5QYWdlTGluayc6XG4gICAgICAgICAgZmluZFRhcmdldChnZXRNc2dCb2R5KDkpKTtcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgJ3Jlc2V0JzpcbiAgICAgICAgICByZXNldElGcmFtZShtZXNzYWdlRGF0YSk7XG4gICAgICAgICAgYnJlYWtcblxuICAgICAgICBjYXNlICdpbml0JzpcbiAgICAgICAgICByZXNpemVJRnJhbWUoKTtcbiAgICAgICAgICBvbignb25Jbml0JywgbWVzc2FnZURhdGEuaWZyYW1lKTtcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmVzaXplSUZyYW1lKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFzU2V0dGluZ3MoaWZyYW1lSWQpIHtcbiAgICAgIHZhciByZXRCb29sID0gdHJ1ZTtcblxuICAgICAgaWYgKCFzZXR0aW5nc1tpZnJhbWVJZF0pIHtcbiAgICAgICAgcmV0Qm9vbCA9IGZhbHNlO1xuICAgICAgICB3YXJuKFxuICAgICAgICAgIG1lc3NhZ2VEYXRhLnR5cGUgK1xuICAgICAgICAgICAgJyBObyBzZXR0aW5ncyBmb3IgJyArXG4gICAgICAgICAgICBpZnJhbWVJZCArXG4gICAgICAgICAgICAnLiBNZXNzYWdlIHdhczogJyArXG4gICAgICAgICAgICBtc2dcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJldEJvb2xcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpRnJhbWVSZWFkeU1zZ1JlY2VpdmVkKCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtc3ludGF4LCBndWFyZC1mb3ItaW5cbiAgICAgIGZvciAodmFyIGlmcmFtZUlkIGluIHNldHRpbmdzKSB7XG4gICAgICAgIHRyaWdnZXIoXG4gICAgICAgICAgJ2lGcmFtZSByZXF1ZXN0ZWQgaW5pdCcsXG4gICAgICAgICAgY3JlYXRlT3V0Z29pbmdNc2coaWZyYW1lSWQpLFxuICAgICAgICAgIHNldHRpbmdzW2lmcmFtZUlkXS5pZnJhbWUsXG4gICAgICAgICAgaWZyYW1lSWRcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaXJzdFJ1bigpIHtcbiAgICAgIGlmIChzZXR0aW5nc1tpZnJhbWVJZF0pIHtcbiAgICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmZpcnN0UnVuID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIG1zZyA9IGV2ZW50LmRhdGEsXG4gICAgICBtZXNzYWdlRGF0YSA9IHt9LFxuICAgICAgaWZyYW1lSWQgPSBudWxsO1xuXG4gICAgaWYgKCdbaUZyYW1lUmVzaXplckNoaWxkXVJlYWR5JyA9PT0gbXNnKSB7XG4gICAgICBpRnJhbWVSZWFkeU1zZ1JlY2VpdmVkKCk7XG4gICAgfSBlbHNlIGlmIChpc01lc3NhZ2VGb3JVcygpKSB7XG4gICAgICBtZXNzYWdlRGF0YSA9IHByb2Nlc3NNc2coKTtcbiAgICAgIGlmcmFtZUlkID0gbWVzc2FnZURhdGEuaWQ7XG4gICAgICBpZiAoc2V0dGluZ3NbaWZyYW1lSWRdKSB7XG4gICAgICAgIHNldHRpbmdzW2lmcmFtZUlkXS5sb2FkZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzTWVzc2FnZUZyb21NZXRhUGFyZW50KCkgJiYgaGFzU2V0dGluZ3MoaWZyYW1lSWQpKSB7XG4gICAgICAgIGxvZyhpZnJhbWVJZCwgJ1JlY2VpdmVkOiAnICsgbXNnKTtcblxuICAgICAgICBpZiAoY2hlY2tJRnJhbWVFeGlzdHMoKSAmJiBpc01lc3NhZ2VGcm9tSUZyYW1lKCkpIHtcbiAgICAgICAgICBhY3Rpb25Nc2coKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpbmZvKGlmcmFtZUlkLCAnSWdub3JlZDogJyArIG1zZyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY2hrRXZlbnQoaWZyYW1lSWQsIGZ1bmNOYW1lLCB2YWwpIHtcbiAgICB2YXIgZnVuYyA9IG51bGwsXG4gICAgICByZXRWYWwgPSBudWxsO1xuXG4gICAgaWYgKHNldHRpbmdzW2lmcmFtZUlkXSkge1xuICAgICAgZnVuYyA9IHNldHRpbmdzW2lmcmFtZUlkXVtmdW5jTmFtZV07XG5cbiAgICAgIGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2YgZnVuYykge1xuICAgICAgICByZXRWYWwgPSBmdW5jKHZhbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgIGZ1bmNOYW1lICsgJyBvbiBpRnJhbWVbJyArIGlmcmFtZUlkICsgJ10gaXMgbm90IGEgZnVuY3Rpb24nXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmV0VmFsXG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVJZnJhbWVMaXN0ZW5lcnMoaWZyYW1lKSB7XG4gICAgdmFyIGlmcmFtZUlkID0gaWZyYW1lLmlkO1xuICAgIGRlbGV0ZSBzZXR0aW5nc1tpZnJhbWVJZF07XG4gIH1cblxuICBmdW5jdGlvbiBjbG9zZUlGcmFtZShpZnJhbWUpIHtcbiAgICB2YXIgaWZyYW1lSWQgPSBpZnJhbWUuaWQ7XG4gICAgaWYgKGNoa0V2ZW50KGlmcmFtZUlkLCAnb25DbG9zZScsIGlmcmFtZUlkKSA9PT0gZmFsc2UpIHtcbiAgICAgIGxvZyhpZnJhbWVJZCwgJ0Nsb3NlIGlmcmFtZSBjYW5jZWxsZWQgYnkgb25DbG9zZSBldmVudCcpO1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGxvZyhpZnJhbWVJZCwgJ1JlbW92aW5nIGlGcmFtZTogJyArIGlmcmFtZUlkKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBDYXRjaCByYWNlIGNvbmRpdGlvbiBlcnJvciB3aXRoIFJlYWN0XG4gICAgICBpZiAoaWZyYW1lLnBhcmVudE5vZGUpIHtcbiAgICAgICAgaWZyYW1lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaWZyYW1lKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgd2FybihlcnJvcik7XG4gICAgfVxuXG4gICAgY2hrRXZlbnQoaWZyYW1lSWQsICdvbkNsb3NlZCcsIGlmcmFtZUlkKTtcbiAgICBsb2coaWZyYW1lSWQsICctLScpO1xuICAgIHJlbW92ZUlmcmFtZUxpc3RlbmVycyhpZnJhbWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0UGFnZVBvc2l0aW9uKGlmcmFtZUlkKSB7XG4gICAgaWYgKG51bGwgPT09IHBhZ2VQb3NpdGlvbikge1xuICAgICAgcGFnZVBvc2l0aW9uID0ge1xuICAgICAgICB4OlxuICAgICAgICAgIHdpbmRvdy5wYWdlWE9mZnNldCAhPT0gdW5kZWZpbmVkJDFcbiAgICAgICAgICAgID8gd2luZG93LnBhZ2VYT2Zmc2V0XG4gICAgICAgICAgICA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0LFxuICAgICAgICB5OlxuICAgICAgICAgIHdpbmRvdy5wYWdlWU9mZnNldCAhPT0gdW5kZWZpbmVkJDFcbiAgICAgICAgICAgID8gd2luZG93LnBhZ2VZT2Zmc2V0XG4gICAgICAgICAgICA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3BcbiAgICAgIH07XG4gICAgICBsb2coXG4gICAgICAgIGlmcmFtZUlkLFxuICAgICAgICAnR2V0IHBhZ2UgcG9zaXRpb246ICcgKyBwYWdlUG9zaXRpb24ueCArICcsJyArIHBhZ2VQb3NpdGlvbi55XG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNldFBhZ2VQb3NpdGlvbihpZnJhbWVJZCkge1xuICAgIGlmIChudWxsICE9PSBwYWdlUG9zaXRpb24pIHtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbyhwYWdlUG9zaXRpb24ueCwgcGFnZVBvc2l0aW9uLnkpO1xuICAgICAgbG9nKFxuICAgICAgICBpZnJhbWVJZCxcbiAgICAgICAgJ1NldCBwYWdlIHBvc2l0aW9uOiAnICsgcGFnZVBvc2l0aW9uLnggKyAnLCcgKyBwYWdlUG9zaXRpb24ueVxuICAgICAgKTtcbiAgICAgIHVuc2V0UGFnZVBvc2l0aW9uKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gdW5zZXRQYWdlUG9zaXRpb24oKSB7XG4gICAgcGFnZVBvc2l0aW9uID0gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlc2V0SUZyYW1lKG1lc3NhZ2VEYXRhKSB7XG4gICAgZnVuY3Rpb24gcmVzZXQoKSB7XG4gICAgICBzZXRTaXplKG1lc3NhZ2VEYXRhKTtcbiAgICAgIHRyaWdnZXIoJ3Jlc2V0JywgJ3Jlc2V0JywgbWVzc2FnZURhdGEuaWZyYW1lLCBtZXNzYWdlRGF0YS5pZCk7XG4gICAgfVxuXG4gICAgbG9nKFxuICAgICAgbWVzc2FnZURhdGEuaWQsXG4gICAgICAnU2l6ZSByZXNldCByZXF1ZXN0ZWQgYnkgJyArXG4gICAgICAgICgnaW5pdCcgPT09IG1lc3NhZ2VEYXRhLnR5cGUgPyAnaG9zdCBwYWdlJyA6ICdpRnJhbWUnKVxuICAgICk7XG4gICAgZ2V0UGFnZVBvc2l0aW9uKG1lc3NhZ2VEYXRhLmlkKTtcbiAgICBzeW5jUmVzaXplKHJlc2V0LCBtZXNzYWdlRGF0YSwgJ3Jlc2V0Jyk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRTaXplKG1lc3NhZ2VEYXRhKSB7XG4gICAgZnVuY3Rpb24gc2V0RGltZW5zaW9uKGRpbWVuc2lvbikge1xuICAgICAgaWYgKCFtZXNzYWdlRGF0YS5pZCkge1xuICAgICAgICBsb2coJ3VuZGVmaW5lZCcsICdtZXNzYWdlRGF0YSBpZCBub3Qgc2V0Jyk7XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgbWVzc2FnZURhdGEuaWZyYW1lLnN0eWxlW2RpbWVuc2lvbl0gPSBtZXNzYWdlRGF0YVtkaW1lbnNpb25dICsgJ3B4JztcbiAgICAgIGxvZyhcbiAgICAgICAgbWVzc2FnZURhdGEuaWQsXG4gICAgICAgICdJRnJhbWUgKCcgK1xuICAgICAgICAgIGlmcmFtZUlkICtcbiAgICAgICAgICAnKSAnICtcbiAgICAgICAgICBkaW1lbnNpb24gK1xuICAgICAgICAgICcgc2V0IHRvICcgK1xuICAgICAgICAgIG1lc3NhZ2VEYXRhW2RpbWVuc2lvbl0gK1xuICAgICAgICAgICdweCdcbiAgICAgICk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hrWmVybyhkaW1lbnNpb24pIHtcbiAgICAgIC8vIEZpcmVGb3ggc2V0cyBkaW1lbnNpb24gb2YgaGlkZGVuIGlGcmFtZXMgdG8gemVyby5cbiAgICAgIC8vIFNvIGlmIHdlIGRldGVjdCB0aGF0IHNldCB1cCBhbiBldmVudCB0byBjaGVjayBmb3JcbiAgICAgIC8vIHdoZW4gaUZyYW1lIGJlY29tZXMgdmlzaWJsZS5cblxuICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gLy8gTm90IHRlc3RhYmxlIGluIFBoYW50b21KU1xuICAgICAgaWYgKCFoaWRkZW5DaGVja0VuYWJsZWQgJiYgJzAnID09PSBtZXNzYWdlRGF0YVtkaW1lbnNpb25dKSB7XG4gICAgICAgIGhpZGRlbkNoZWNrRW5hYmxlZCA9IHRydWU7XG4gICAgICAgIGxvZyhpZnJhbWVJZCwgJ0hpZGRlbiBpRnJhbWUgZGV0ZWN0ZWQsIGNyZWF0aW5nIHZpc2liaWxpdHkgbGlzdGVuZXInKTtcbiAgICAgICAgZml4SGlkZGVuSUZyYW1lcygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHByb2Nlc3NEaW1lbnNpb24oZGltZW5zaW9uKSB7XG4gICAgICBzZXREaW1lbnNpb24oZGltZW5zaW9uKTtcbiAgICAgIGNoa1plcm8oZGltZW5zaW9uKTtcbiAgICB9XG5cbiAgICB2YXIgaWZyYW1lSWQgPSBtZXNzYWdlRGF0YS5pZnJhbWUuaWQ7XG5cbiAgICBpZiAoc2V0dGluZ3NbaWZyYW1lSWRdKSB7XG4gICAgICBpZiAoc2V0dGluZ3NbaWZyYW1lSWRdLnNpemVIZWlnaHQpIHtcbiAgICAgICAgcHJvY2Vzc0RpbWVuc2lvbignaGVpZ2h0Jyk7XG4gICAgICB9XG4gICAgICBpZiAoc2V0dGluZ3NbaWZyYW1lSWRdLnNpemVXaWR0aCkge1xuICAgICAgICBwcm9jZXNzRGltZW5zaW9uKCd3aWR0aCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHN5bmNSZXNpemUoZnVuYywgbWVzc2FnZURhdGEsIGRvTm90U3luYykge1xuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLyAvLyBOb3QgdGVzdGFibGUgaW4gUGhhbnRvbUpTXG4gICAgaWYgKFxuICAgICAgZG9Ob3RTeW5jICE9PSBtZXNzYWdlRGF0YS50eXBlICYmXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgJiZcbiAgICAgIC8vIGluY2x1ZGluZyBjaGVjayBmb3IgamFzbWluZSBiZWNhdXNlIGhhZCB0cm91YmxlIGdldHRpbmcgc3B5IHRvIHdvcmsgaW4gdW5pdCB0ZXN0IHVzaW5nIHJlcXVlc3RBbmltYXRpb25GcmFtZVxuICAgICAgIXdpbmRvdy5qYXNtaW5lXG4gICAgKSB7XG4gICAgICBsb2cobWVzc2FnZURhdGEuaWQsICdSZXF1ZXN0aW5nIGFuaW1hdGlvbiBmcmFtZScpO1xuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmdW5jKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gdHJpZ2dlcihjYWxsZWVNc2csIG1zZywgaWZyYW1lLCBpZCwgbm9SZXNwb25zZVdhcm5pbmcpIHtcbiAgICBmdW5jdGlvbiBwb3N0TWVzc2FnZVRvSUZyYW1lKCkge1xuICAgICAgdmFyIHRhcmdldCA9IHNldHRpbmdzW2lkXSAmJiBzZXR0aW5nc1tpZF0udGFyZ2V0T3JpZ2luO1xuICAgICAgbG9nKFxuICAgICAgICBpZCxcbiAgICAgICAgJ1snICtcbiAgICAgICAgICBjYWxsZWVNc2cgK1xuICAgICAgICAgICddIFNlbmRpbmcgbXNnIHRvIGlmcmFtZVsnICtcbiAgICAgICAgICBpZCArXG4gICAgICAgICAgJ10gKCcgK1xuICAgICAgICAgIG1zZyArXG4gICAgICAgICAgJykgdGFyZ2V0T3JpZ2luOiAnICtcbiAgICAgICAgICB0YXJnZXRcbiAgICAgICk7XG4gICAgICBpZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShtc2dJZCArIG1zZywgdGFyZ2V0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpRnJhbWVOb3RGb3VuZCgpIHtcbiAgICAgIHdhcm4oaWQsICdbJyArIGNhbGxlZU1zZyArICddIElGcmFtZSgnICsgaWQgKyAnKSBub3QgZm91bmQnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGtBbmRTZW5kKCkge1xuICAgICAgaWYgKFxuICAgICAgICBpZnJhbWUgJiZcbiAgICAgICAgJ2NvbnRlbnRXaW5kb3cnIGluIGlmcmFtZSAmJlxuICAgICAgICBudWxsICE9PSBpZnJhbWUuY29udGVudFdpbmRvd1xuICAgICAgKSB7XG4gICAgICAgIC8vIE51bGwgdGVzdCBmb3IgUGhhbnRvbUpTXG4gICAgICAgIHBvc3RNZXNzYWdlVG9JRnJhbWUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlGcmFtZU5vdEZvdW5kKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2Fybk9uTm9SZXNwb25zZSgpIHtcbiAgICAgIGZ1bmN0aW9uIHdhcm5pbmcoKSB7XG4gICAgICAgIGlmIChzZXR0aW5nc1tpZF0gJiYgIXNldHRpbmdzW2lkXS5sb2FkZWQgJiYgIWVycm9yU2hvd24pIHtcbiAgICAgICAgICBlcnJvclNob3duID0gdHJ1ZTtcbiAgICAgICAgICB3YXJuKFxuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAnSUZyYW1lIGhhcyBub3QgcmVzcG9uZGVkIHdpdGhpbiAnICtcbiAgICAgICAgICAgICAgc2V0dGluZ3NbaWRdLndhcm5pbmdUaW1lb3V0IC8gMTAwMCArXG4gICAgICAgICAgICAgICcgc2Vjb25kcy4gQ2hlY2sgaUZyYW1lUmVzaXplci5jb250ZW50V2luZG93LmpzIGhhcyBiZWVuIGxvYWRlZCBpbiBpRnJhbWUuIFRoaXMgbWVzc2FnZSBjYW4gYmUgaWdub3JlZCBpZiBldmVyeXRoaW5nIGlzIHdvcmtpbmcsIG9yIHlvdSBjYW4gc2V0IHRoZSB3YXJuaW5nVGltZW91dCBvcHRpb24gdG8gYSBoaWdoZXIgdmFsdWUgb3IgemVybyB0byBzdXBwcmVzcyB0aGlzIHdhcm5pbmcuJ1xuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICAhIW5vUmVzcG9uc2VXYXJuaW5nICYmXG4gICAgICAgIHNldHRpbmdzW2lkXSAmJlxuICAgICAgICAhIXNldHRpbmdzW2lkXS53YXJuaW5nVGltZW91dFxuICAgICAgKSB7XG4gICAgICAgIHNldHRpbmdzW2lkXS5tc2dUaW1lb3V0ID0gc2V0VGltZW91dChcbiAgICAgICAgICB3YXJuaW5nLFxuICAgICAgICAgIHNldHRpbmdzW2lkXS53YXJuaW5nVGltZW91dFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBlcnJvclNob3duID0gZmFsc2U7XG5cbiAgICBpZCA9IGlkIHx8IGlmcmFtZS5pZDtcblxuICAgIGlmIChzZXR0aW5nc1tpZF0pIHtcbiAgICAgIGNoa0FuZFNlbmQoKTtcbiAgICAgIHdhcm5Pbk5vUmVzcG9uc2UoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBjcmVhdGVPdXRnb2luZ01zZyhpZnJhbWVJZCkge1xuICAgIHJldHVybiAoXG4gICAgICBpZnJhbWVJZCArXG4gICAgICAnOicgK1xuICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmJvZHlNYXJnaW5WMSArXG4gICAgICAnOicgK1xuICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLnNpemVXaWR0aCArXG4gICAgICAnOicgK1xuICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmxvZyArXG4gICAgICAnOicgK1xuICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmludGVydmFsICtcbiAgICAgICc6JyArXG4gICAgICBzZXR0aW5nc1tpZnJhbWVJZF0uZW5hYmxlUHVibGljTWV0aG9kcyArXG4gICAgICAnOicgK1xuICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmF1dG9SZXNpemUgK1xuICAgICAgJzonICtcbiAgICAgIHNldHRpbmdzW2lmcmFtZUlkXS5ib2R5TWFyZ2luICtcbiAgICAgICc6JyArXG4gICAgICBzZXR0aW5nc1tpZnJhbWVJZF0uaGVpZ2h0Q2FsY3VsYXRpb25NZXRob2QgK1xuICAgICAgJzonICtcbiAgICAgIHNldHRpbmdzW2lmcmFtZUlkXS5ib2R5QmFja2dyb3VuZCArXG4gICAgICAnOicgK1xuICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmJvZHlQYWRkaW5nICtcbiAgICAgICc6JyArXG4gICAgICBzZXR0aW5nc1tpZnJhbWVJZF0udG9sZXJhbmNlICtcbiAgICAgICc6JyArXG4gICAgICBzZXR0aW5nc1tpZnJhbWVJZF0uaW5QYWdlTGlua3MgK1xuICAgICAgJzonICtcbiAgICAgIHNldHRpbmdzW2lmcmFtZUlkXS5yZXNpemVGcm9tICtcbiAgICAgICc6JyArXG4gICAgICBzZXR0aW5nc1tpZnJhbWVJZF0ud2lkdGhDYWxjdWxhdGlvbk1ldGhvZFxuICAgIClcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldHVwSUZyYW1lKGlmcmFtZSwgb3B0aW9ucykge1xuICAgIGZ1bmN0aW9uIHNldExpbWl0cygpIHtcbiAgICAgIGZ1bmN0aW9uIGFkZFN0eWxlKHN0eWxlKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBJbmZpbml0eSAhPT0gc2V0dGluZ3NbaWZyYW1lSWRdW3N0eWxlXSAmJlxuICAgICAgICAgIDAgIT09IHNldHRpbmdzW2lmcmFtZUlkXVtzdHlsZV1cbiAgICAgICAgKSB7XG4gICAgICAgICAgaWZyYW1lLnN0eWxlW3N0eWxlXSA9IHNldHRpbmdzW2lmcmFtZUlkXVtzdHlsZV0gKyAncHgnO1xuICAgICAgICAgIGxvZyhcbiAgICAgICAgICAgIGlmcmFtZUlkLFxuICAgICAgICAgICAgJ1NldCAnICsgc3R5bGUgKyAnID0gJyArIHNldHRpbmdzW2lmcmFtZUlkXVtzdHlsZV0gKyAncHgnXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBjaGtNaW5NYXgoZGltZW5zaW9uKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF1bJ21pbicgKyBkaW1lbnNpb25dID5cbiAgICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF1bJ21heCcgKyBkaW1lbnNpb25dXG4gICAgICAgICkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICdWYWx1ZSBmb3IgbWluJyArXG4gICAgICAgICAgICAgIGRpbWVuc2lvbiArXG4gICAgICAgICAgICAgICcgY2FuIG5vdCBiZSBncmVhdGVyIHRoYW4gbWF4JyArXG4gICAgICAgICAgICAgIGRpbWVuc2lvblxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjaGtNaW5NYXgoJ0hlaWdodCcpO1xuICAgICAgY2hrTWluTWF4KCdXaWR0aCcpO1xuXG4gICAgICBhZGRTdHlsZSgnbWF4SGVpZ2h0Jyk7XG4gICAgICBhZGRTdHlsZSgnbWluSGVpZ2h0Jyk7XG4gICAgICBhZGRTdHlsZSgnbWF4V2lkdGgnKTtcbiAgICAgIGFkZFN0eWxlKCdtaW5XaWR0aCcpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld0lkKCkge1xuICAgICAgdmFyIGlkID0gKG9wdGlvbnMgJiYgb3B0aW9ucy5pZCkgfHwgZGVmYXVsdHMuaWQgKyBjb3VudCsrO1xuICAgICAgaWYgKG51bGwgIT09IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSkge1xuICAgICAgICBpZCArPSBjb3VudCsrO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGlkXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZW5zdXJlSGFzSWQoaWZyYW1lSWQpIHtcbiAgICAgIGlmICgnJyA9PT0gaWZyYW1lSWQpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW11bHRpLWFzc2lnblxuICAgICAgICBpZnJhbWUuaWQgPSBpZnJhbWVJZCA9IG5ld0lkKCk7XG4gICAgICAgIGxvZ0VuYWJsZWQgPSAob3B0aW9ucyB8fCB7fSkubG9nO1xuICAgICAgICBsb2coXG4gICAgICAgICAgaWZyYW1lSWQsXG4gICAgICAgICAgJ0FkZGVkIG1pc3NpbmcgaWZyYW1lIElEOiAnICsgaWZyYW1lSWQgKyAnICgnICsgaWZyYW1lLnNyYyArICcpJ1xuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaWZyYW1lSWRcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRTY3JvbGxpbmcoKSB7XG4gICAgICBsb2coXG4gICAgICAgIGlmcmFtZUlkLFxuICAgICAgICAnSUZyYW1lIHNjcm9sbGluZyAnICtcbiAgICAgICAgICAoc2V0dGluZ3NbaWZyYW1lSWRdICYmIHNldHRpbmdzW2lmcmFtZUlkXS5zY3JvbGxpbmdcbiAgICAgICAgICAgID8gJ2VuYWJsZWQnXG4gICAgICAgICAgICA6ICdkaXNhYmxlZCcpICtcbiAgICAgICAgICAnIGZvciAnICtcbiAgICAgICAgICBpZnJhbWVJZFxuICAgICAgKTtcbiAgICAgIGlmcmFtZS5zdHlsZS5vdmVyZmxvdyA9XG4gICAgICAgIGZhbHNlID09PSAoc2V0dGluZ3NbaWZyYW1lSWRdICYmIHNldHRpbmdzW2lmcmFtZUlkXS5zY3JvbGxpbmcpXG4gICAgICAgICAgPyAnaGlkZGVuJ1xuICAgICAgICAgIDogJ2F1dG8nO1xuICAgICAgc3dpdGNoIChzZXR0aW5nc1tpZnJhbWVJZF0gJiYgc2V0dGluZ3NbaWZyYW1lSWRdLnNjcm9sbGluZykge1xuICAgICAgICBjYXNlICdvbWl0JzpcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgdHJ1ZTpcbiAgICAgICAgICBpZnJhbWUuc2Nyb2xsaW5nID0gJ3llcyc7XG4gICAgICAgICAgYnJlYWtcblxuICAgICAgICBjYXNlIGZhbHNlOlxuICAgICAgICAgIGlmcmFtZS5zY3JvbGxpbmcgPSAnbm8nO1xuICAgICAgICAgIGJyZWFrXG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBpZnJhbWUuc2Nyb2xsaW5nID0gc2V0dGluZ3NbaWZyYW1lSWRdXG4gICAgICAgICAgICA/IHNldHRpbmdzW2lmcmFtZUlkXS5zY3JvbGxpbmdcbiAgICAgICAgICAgIDogJ25vJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUaGUgVjEgaUZyYW1lIHNjcmlwdCBleHBlY3RzIGFuIGludCwgd2hlcmUgYXMgaW4gVjIgZXhwZWN0cyBhIENTU1xuICAgIC8vIHN0cmluZyB2YWx1ZSBzdWNoIGFzICcxcHggM2VtJywgc28gaWYgd2UgaGF2ZSBhbiBpbnQgZm9yIFYyLCBzZXQgVjE9VjJcbiAgICAvLyBhbmQgdGhlbiBjb252ZXJ0IFYyIHRvIGEgc3RyaW5nIFBYIHZhbHVlLlxuICAgIGZ1bmN0aW9uIHNldHVwQm9keU1hcmdpblZhbHVlcygpIHtcbiAgICAgIGlmIChcbiAgICAgICAgJ251bWJlcicgPT09XG4gICAgICAgICAgdHlwZW9mIChzZXR0aW5nc1tpZnJhbWVJZF0gJiYgc2V0dGluZ3NbaWZyYW1lSWRdLmJvZHlNYXJnaW4pIHx8XG4gICAgICAgICcwJyA9PT0gKHNldHRpbmdzW2lmcmFtZUlkXSAmJiBzZXR0aW5nc1tpZnJhbWVJZF0uYm9keU1hcmdpbilcbiAgICAgICkge1xuICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF0uYm9keU1hcmdpblYxID0gc2V0dGluZ3NbaWZyYW1lSWRdLmJvZHlNYXJnaW47XG4gICAgICAgIHNldHRpbmdzW2lmcmFtZUlkXS5ib2R5TWFyZ2luID1cbiAgICAgICAgICAnJyArIHNldHRpbmdzW2lmcmFtZUlkXS5ib2R5TWFyZ2luICsgJ3B4JztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGVja1Jlc2V0KCkge1xuICAgICAgLy8gUmVkdWNlIHNjb3BlIG9mIGZpcnN0UnVuIHRvIGZ1bmN0aW9uLCBiZWNhdXNlIElFOCdzIEpTIGV4ZWN1dGlvblxuICAgICAgLy8gY29udGV4dCBzdGFjayBpcyBib3JrZWQgYW5kIHRoaXMgdmFsdWUgZ2V0cyBleHRlcm5hbGx5XG4gICAgICAvLyBjaGFuZ2VkIG1pZHdheSB0aHJvdWdoIHJ1bm5pbmcgdGhpcyBmdW5jdGlvbiEhIVxuICAgICAgdmFyIGZpcnN0UnVuID0gc2V0dGluZ3NbaWZyYW1lSWRdICYmIHNldHRpbmdzW2lmcmFtZUlkXS5maXJzdFJ1bixcbiAgICAgICAgcmVzZXRSZXF1ZXJ0TWV0aG9kID1cbiAgICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF0gJiZcbiAgICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF0uaGVpZ2h0Q2FsY3VsYXRpb25NZXRob2QgaW4gcmVzZXRSZXF1aXJlZE1ldGhvZHM7XG5cbiAgICAgIGlmICghZmlyc3RSdW4gJiYgcmVzZXRSZXF1ZXJ0TWV0aG9kKSB7XG4gICAgICAgIHJlc2V0SUZyYW1lKHsgaWZyYW1lOiBpZnJhbWUsIGhlaWdodDogMCwgd2lkdGg6IDAsIHR5cGU6ICdpbml0JyB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXR1cElGcmFtZU9iamVjdCgpIHtcbiAgICAgIGlmIChzZXR0aW5nc1tpZnJhbWVJZF0pIHtcbiAgICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmlmcmFtZS5pRnJhbWVSZXNpemVyID0ge1xuICAgICAgICAgIGNsb3NlOiBjbG9zZUlGcmFtZS5iaW5kKG51bGwsIHNldHRpbmdzW2lmcmFtZUlkXS5pZnJhbWUpLFxuXG4gICAgICAgICAgcmVtb3ZlTGlzdGVuZXJzOiByZW1vdmVJZnJhbWVMaXN0ZW5lcnMuYmluZChcbiAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF0uaWZyYW1lXG4gICAgICAgICAgKSxcblxuICAgICAgICAgIHJlc2l6ZTogdHJpZ2dlci5iaW5kKFxuICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICdXaW5kb3cgcmVzaXplJyxcbiAgICAgICAgICAgICdyZXNpemUnLFxuICAgICAgICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmlmcmFtZVxuICAgICAgICAgICksXG5cbiAgICAgICAgICBtb3ZlVG9BbmNob3I6IGZ1bmN0aW9uIChhbmNob3IpIHtcbiAgICAgICAgICAgIHRyaWdnZXIoXG4gICAgICAgICAgICAgICdNb3ZlIHRvIGFuY2hvcicsXG4gICAgICAgICAgICAgICdtb3ZlVG9BbmNob3I6JyArIGFuY2hvcixcbiAgICAgICAgICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmlmcmFtZSxcbiAgICAgICAgICAgICAgaWZyYW1lSWRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgbWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpO1xuICAgICAgICAgICAgdHJpZ2dlcihcbiAgICAgICAgICAgICAgJ1NlbmQgTWVzc2FnZScsXG4gICAgICAgICAgICAgICdtZXNzYWdlOicgKyBtZXNzYWdlLFxuICAgICAgICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF0uaWZyYW1lLFxuICAgICAgICAgICAgICBpZnJhbWVJZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gV2UgaGF2ZSB0byBjYWxsIHRyaWdnZXIgdHdpY2UsIGFzIHdlIGNhbiBub3QgYmUgc3VyZSBpZiBhbGxcbiAgICAvLyBpZnJhbWVzIGhhdmUgY29tcGxldGVkIGxvYWRpbmcgd2hlbiB0aGlzIGNvZGUgcnVucy4gVGhlXG4gICAgLy8gZXZlbnQgbGlzdGVuZXIgYWxzbyBjYXRjaGVzIHRoZSBwYWdlIGNoYW5naW5nIGluIHRoZSBpRnJhbWUuXG4gICAgZnVuY3Rpb24gaW5pdChtc2cpIHtcbiAgICAgIGZ1bmN0aW9uIGlGcmFtZUxvYWRlZCgpIHtcbiAgICAgICAgdHJpZ2dlcignaUZyYW1lLm9ubG9hZCcsIG1zZywgaWZyYW1lLCB1bmRlZmluZWQkMSwgdHJ1ZSk7XG4gICAgICAgIGNoZWNrUmVzZXQoKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY3JlYXRlRGVzdHJveU9ic2VydmVyKE11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgICAgICAgaWYgKCFpZnJhbWUucGFyZW50Tm9kZSkge1xuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGRlc3Ryb3lPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobXV0YXRpb24pIHtcbiAgICAgICAgICAgIHZhciByZW1vdmVkTm9kZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChtdXRhdGlvbi5yZW1vdmVkTm9kZXMpOyAvLyBUcmFuc2Zvcm0gTm9kZUxpc3QgaW50byBhbiBBcnJheVxuICAgICAgICAgICAgcmVtb3ZlZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKHJlbW92ZWROb2RlKSB7XG4gICAgICAgICAgICAgIGlmIChyZW1vdmVkTm9kZSA9PT0gaWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgY2xvc2VJRnJhbWUoaWZyYW1lKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBkZXN0cm95T2JzZXJ2ZXIub2JzZXJ2ZShpZnJhbWUucGFyZW50Tm9kZSwge1xuICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdmFyIE11dGF0aW9uT2JzZXJ2ZXIgPSBnZXRNdXRhdGlvbk9ic2VydmVyKCk7XG4gICAgICBpZiAoTXV0YXRpb25PYnNlcnZlcikge1xuICAgICAgICBjcmVhdGVEZXN0cm95T2JzZXJ2ZXIoTXV0YXRpb25PYnNlcnZlcik7XG4gICAgICB9XG5cbiAgICAgIGFkZEV2ZW50TGlzdGVuZXIoaWZyYW1lLCAnbG9hZCcsIGlGcmFtZUxvYWRlZCk7XG4gICAgICB0cmlnZ2VyKCdpbml0JywgbXNnLCBpZnJhbWUsIHVuZGVmaW5lZCQxLCB0cnVlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGVja09wdGlvbnMob3B0aW9ucykge1xuICAgICAgaWYgKCdvYmplY3QnICE9PSB0eXBlb2Ygb3B0aW9ucykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdPcHRpb25zIGlzIG5vdCBhbiBvYmplY3QnKVxuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvcHlPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuICAgICAgZm9yICh2YXIgb3B0aW9uIGluIGRlZmF1bHRzKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGVmYXVsdHMsIG9wdGlvbikpIHtcbiAgICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF1bb3B0aW9uXSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChcbiAgICAgICAgICAgIG9wdGlvbnMsXG4gICAgICAgICAgICBvcHRpb25cbiAgICAgICAgICApXG4gICAgICAgICAgICA/IG9wdGlvbnNbb3B0aW9uXVxuICAgICAgICAgICAgOiBkZWZhdWx0c1tvcHRpb25dO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0VGFyZ2V0T3JpZ2luKHJlbW90ZUhvc3QpIHtcbiAgICAgIHJldHVybiAnJyA9PT0gcmVtb3RlSG9zdCB8fFxuICAgICAgICBudWxsICE9PSByZW1vdGVIb3N0Lm1hdGNoKC9eKGFib3V0OmJsYW5rfGphdmFzY3JpcHQ6fGZpbGU6XFwvXFwvKS8pXG4gICAgICAgID8gJyonXG4gICAgICAgIDogcmVtb3RlSG9zdFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlcHJpY2F0ZShrZXkpIHtcbiAgICAgIHZhciBzcGxpdE5hbWUgPSBrZXkuc3BsaXQoJ0NhbGxiYWNrJyk7XG5cbiAgICAgIGlmIChzcGxpdE5hbWUubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHZhciBuYW1lID1cbiAgICAgICAgICAnb24nICsgc3BsaXROYW1lWzBdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3BsaXROYW1lWzBdLnNsaWNlKDEpO1xuICAgICAgICB0aGlzW25hbWVdID0gdGhpc1trZXldO1xuICAgICAgICBkZWxldGUgdGhpc1trZXldO1xuICAgICAgICB3YXJuKFxuICAgICAgICAgIGlmcmFtZUlkLFxuICAgICAgICAgIFwiRGVwcmVjYXRlZDogJ1wiICtcbiAgICAgICAgICAgIGtleSArXG4gICAgICAgICAgICBcIicgaGFzIGJlZW4gcmVuYW1lZCAnXCIgK1xuICAgICAgICAgICAgbmFtZSArXG4gICAgICAgICAgICBcIicuIFRoZSBvbGQgbWV0aG9kIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciB2ZXJzaW9uLlwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJvY2Vzc09wdGlvbnMob3B0aW9ucykge1xuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICBzZXR0aW5nc1tpZnJhbWVJZF0gPSB7XG4gICAgICAgIGZpcnN0UnVuOiB0cnVlLFxuICAgICAgICBpZnJhbWU6IGlmcmFtZSxcbiAgICAgICAgcmVtb3RlSG9zdDogaWZyYW1lLnNyYyAmJiBpZnJhbWUuc3JjLnNwbGl0KCcvJykuc2xpY2UoMCwgMykuam9pbignLycpXG4gICAgICB9O1xuXG4gICAgICBjaGVja09wdGlvbnMob3B0aW9ucyk7XG4gICAgICBPYmplY3Qua2V5cyhvcHRpb25zKS5mb3JFYWNoKGRlcHJpY2F0ZSwgb3B0aW9ucyk7XG4gICAgICBjb3B5T3B0aW9ucyhvcHRpb25zKTtcblxuICAgICAgaWYgKHNldHRpbmdzW2lmcmFtZUlkXSkge1xuICAgICAgICBzZXR0aW5nc1tpZnJhbWVJZF0udGFyZ2V0T3JpZ2luID1cbiAgICAgICAgICB0cnVlID09PSBzZXR0aW5nc1tpZnJhbWVJZF0uY2hlY2tPcmlnaW5cbiAgICAgICAgICAgID8gZ2V0VGFyZ2V0T3JpZ2luKHNldHRpbmdzW2lmcmFtZUlkXS5yZW1vdGVIb3N0KVxuICAgICAgICAgICAgOiAnKic7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYmVlbkhlcmUoKSB7XG4gICAgICByZXR1cm4gaWZyYW1lSWQgaW4gc2V0dGluZ3MgJiYgJ2lGcmFtZVJlc2l6ZXInIGluIGlmcmFtZVxuICAgIH1cblxuICAgIHZhciBpZnJhbWVJZCA9IGVuc3VyZUhhc0lkKGlmcmFtZS5pZCk7XG5cbiAgICBpZiAoIWJlZW5IZXJlKCkpIHtcbiAgICAgIHByb2Nlc3NPcHRpb25zKG9wdGlvbnMpO1xuICAgICAgc2V0U2Nyb2xsaW5nKCk7XG4gICAgICBzZXRMaW1pdHMoKTtcbiAgICAgIHNldHVwQm9keU1hcmdpblZhbHVlcygpO1xuICAgICAgaW5pdChjcmVhdGVPdXRnb2luZ01zZyhpZnJhbWVJZCkpO1xuICAgICAgc2V0dXBJRnJhbWVPYmplY3QoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2FybihpZnJhbWVJZCwgJ0lnbm9yZWQgaUZyYW1lLCBhbHJlYWR5IHNldHVwLicpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGRlYm91Y2UoZm4sIHRpbWUpIHtcbiAgICBpZiAobnVsbCA9PT0gdGltZXIpIHtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRpbWVyID0gbnVsbDtcbiAgICAgICAgZm4oKTtcbiAgICAgIH0sIHRpbWUpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBmcmFtZVRpbWVyID0ge307XG4gIGZ1bmN0aW9uIGRlYm91bmNlRnJhbWVFdmVudHMoZm4sIHRpbWUsIGZyYW1lSWQpIHtcbiAgICBpZiAoIWZyYW1lVGltZXJbZnJhbWVJZF0pIHtcbiAgICAgIGZyYW1lVGltZXJbZnJhbWVJZF0gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnJhbWVUaW1lcltmcmFtZUlkXSA9IG51bGw7XG4gICAgICAgIGZuKCk7XG4gICAgICB9LCB0aW1lKTtcbiAgICB9XG4gIH1cblxuICAvLyBOb3QgdGVzdGFibGUgaW4gUGhhbnRvbUpTXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG5cbiAgZnVuY3Rpb24gZml4SGlkZGVuSUZyYW1lcygpIHtcbiAgICBmdW5jdGlvbiBjaGVja0lGcmFtZXMoKSB7XG4gICAgICBmdW5jdGlvbiBjaGVja0lGcmFtZShzZXR0aW5nSWQpIHtcbiAgICAgICAgZnVuY3Rpb24gY2hrRGltZW5zaW9uKGRpbWVuc2lvbikge1xuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAnMHB4JyA9PT1cbiAgICAgICAgICAgIChzZXR0aW5nc1tzZXR0aW5nSWRdICYmIHNldHRpbmdzW3NldHRpbmdJZF0uaWZyYW1lLnN0eWxlW2RpbWVuc2lvbl0pXG4gICAgICAgICAgKVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaXNWaXNpYmxlKGVsKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGwgIT09IGVsLm9mZnNldFBhcmVudFxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIHNldHRpbmdzW3NldHRpbmdJZF0gJiZcbiAgICAgICAgICBpc1Zpc2libGUoc2V0dGluZ3Nbc2V0dGluZ0lkXS5pZnJhbWUpICYmXG4gICAgICAgICAgKGNoa0RpbWVuc2lvbignaGVpZ2h0JykgfHwgY2hrRGltZW5zaW9uKCd3aWR0aCcpKVxuICAgICAgICApIHtcbiAgICAgICAgICB0cmlnZ2VyKFxuICAgICAgICAgICAgJ1Zpc2liaWxpdHkgY2hhbmdlJyxcbiAgICAgICAgICAgICdyZXNpemUnLFxuICAgICAgICAgICAgc2V0dGluZ3Nbc2V0dGluZ0lkXS5pZnJhbWUsXG4gICAgICAgICAgICBzZXR0aW5nSWRcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIE9iamVjdC5rZXlzKHNldHRpbmdzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgY2hlY2tJRnJhbWUoa2V5KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG11dGF0aW9uT2JzZXJ2ZWQobXV0YXRpb25zKSB7XG4gICAgICBsb2coXG4gICAgICAgICd3aW5kb3cnLFxuICAgICAgICAnTXV0YXRpb24gb2JzZXJ2ZWQ6ICcgKyBtdXRhdGlvbnNbMF0udGFyZ2V0ICsgJyAnICsgbXV0YXRpb25zWzBdLnR5cGVcbiAgICAgICk7XG4gICAgICBkZWJvdWNlKGNoZWNrSUZyYW1lcywgMTYpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZU11dGF0aW9uT2JzZXJ2ZXIoKSB7XG4gICAgICB2YXIgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLFxuICAgICAgICBjb25maWcgPSB7XG4gICAgICAgICAgYXR0cmlidXRlczogdHJ1ZSxcbiAgICAgICAgICBhdHRyaWJ1dGVPbGRWYWx1ZTogZmFsc2UsXG4gICAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSxcbiAgICAgICAgICBjaGFyYWN0ZXJEYXRhT2xkVmFsdWU6IGZhbHNlLFxuICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICBzdWJ0cmVlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIobXV0YXRpb25PYnNlcnZlZCk7XG5cbiAgICAgIG9ic2VydmVyLm9ic2VydmUodGFyZ2V0LCBjb25maWcpO1xuICAgIH1cblxuICAgIHZhciBNdXRhdGlvbk9ic2VydmVyID0gZ2V0TXV0YXRpb25PYnNlcnZlcigpO1xuICAgIGlmIChNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICBjcmVhdGVNdXRhdGlvbk9ic2VydmVyKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcmVzaXplSUZyYW1lcyhldmVudCkge1xuICAgIGZ1bmN0aW9uIHJlc2l6ZSgpIHtcbiAgICAgIHNlbmRUcmlnZ2VyTXNnKCdXaW5kb3cgJyArIGV2ZW50LCAncmVzaXplJyk7XG4gICAgfVxuXG4gICAgbG9nKCd3aW5kb3cnLCAnVHJpZ2dlciBldmVudDogJyArIGV2ZW50KTtcbiAgICBkZWJvdWNlKHJlc2l6ZSwgMTYpO1xuICB9XG5cbiAgLy8gTm90IHRlc3RhYmxlIGluIFBoYW50b21KU1xuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBmdW5jdGlvbiB0YWJWaXNpYmxlKCkge1xuICAgIGZ1bmN0aW9uIHJlc2l6ZSgpIHtcbiAgICAgIHNlbmRUcmlnZ2VyTXNnKCdUYWIgVmlzYWJsZScsICdyZXNpemUnKTtcbiAgICB9XG5cbiAgICBpZiAoJ2hpZGRlbicgIT09IGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSkge1xuICAgICAgbG9nKCdkb2N1bWVudCcsICdUcmlnZ2VyIGV2ZW50OiBWaXNpYmxpdHkgY2hhbmdlJyk7XG4gICAgICBkZWJvdWNlKHJlc2l6ZSwgMTYpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNlbmRUcmlnZ2VyTXNnKGV2ZW50TmFtZSwgZXZlbnQpIHtcbiAgICBmdW5jdGlvbiBpc0lGcmFtZVJlc2l6ZUVuYWJsZWQoaWZyYW1lSWQpIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIHNldHRpbmdzW2lmcmFtZUlkXSAmJlxuICAgICAgICAncGFyZW50JyA9PT0gc2V0dGluZ3NbaWZyYW1lSWRdLnJlc2l6ZUZyb20gJiZcbiAgICAgICAgc2V0dGluZ3NbaWZyYW1lSWRdLmF1dG9SZXNpemUgJiZcbiAgICAgICAgIXNldHRpbmdzW2lmcmFtZUlkXS5maXJzdFJ1blxuICAgICAgKVxuICAgIH1cblxuICAgIE9iamVjdC5rZXlzKHNldHRpbmdzKS5mb3JFYWNoKGZ1bmN0aW9uIChpZnJhbWVJZCkge1xuICAgICAgaWYgKGlzSUZyYW1lUmVzaXplRW5hYmxlZChpZnJhbWVJZCkpIHtcbiAgICAgICAgdHJpZ2dlcihldmVudE5hbWUsIGV2ZW50LCBzZXR0aW5nc1tpZnJhbWVJZF0uaWZyYW1lLCBpZnJhbWVJZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXR1cEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGFkZEV2ZW50TGlzdGVuZXIod2luZG93LCAnbWVzc2FnZScsIGlGcmFtZUxpc3RlbmVyKTtcblxuICAgIGFkZEV2ZW50TGlzdGVuZXIod2luZG93LCAncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgcmVzaXplSUZyYW1lcygncmVzaXplJyk7XG4gICAgfSk7XG5cbiAgICBhZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAndmlzaWJpbGl0eWNoYW5nZScsIHRhYlZpc2libGUpO1xuXG4gICAgYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudCwgJy13ZWJraXQtdmlzaWJpbGl0eWNoYW5nZScsIHRhYlZpc2libGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gZmFjdG9yeSgpIHtcbiAgICBmdW5jdGlvbiBpbml0KG9wdGlvbnMsIGVsZW1lbnQpIHtcbiAgICAgIGZ1bmN0aW9uIGNoa1R5cGUoKSB7XG4gICAgICAgIGlmICghZWxlbWVudC50YWdOYW1lKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignT2JqZWN0IGlzIG5vdCBhIHZhbGlkIERPTSBlbGVtZW50JylcbiAgICAgICAgfSBlbHNlIGlmICgnSUZSQU1FJyAhPT0gZWxlbWVudC50YWdOYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgICAgICAgJ0V4cGVjdGVkIDxJRlJBTUU+IHRhZywgZm91bmQgPCcgKyBlbGVtZW50LnRhZ05hbWUgKyAnPidcbiAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgY2hrVHlwZSgpO1xuICAgICAgICBzZXR1cElGcmFtZShlbGVtZW50LCBvcHRpb25zKTtcbiAgICAgICAgaUZyYW1lcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdhcm5EZXByZWNhdGVkT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmVuYWJsZVB1YmxpY01ldGhvZHMpIHtcbiAgICAgICAgd2FybihcbiAgICAgICAgICAnZW5hYmxlUHVibGljTWV0aG9kcyBvcHRpb24gaGFzIGJlZW4gcmVtb3ZlZCwgcHVibGljIG1ldGhvZHMgYXJlIG5vdyBhbHdheXMgYXZhaWxhYmxlIGluIHRoZSBpRnJhbWUnXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGlGcmFtZXM7XG5cbiAgICBzZXR1cFJlcXVlc3RBbmltYXRpb25GcmFtZSgpO1xuICAgIHNldHVwRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiBpRnJhbWVSZXNpemVGKG9wdGlvbnMsIHRhcmdldCkge1xuICAgICAgaUZyYW1lcyA9IFtdOyAvLyBPbmx5IHJldHVybiBpRnJhbWVzIHBhc3QgaW4gb24gdGhpcyBjYWxsXG5cbiAgICAgIHdhcm5EZXByZWNhdGVkT3B0aW9ucyhvcHRpb25zKTtcblxuICAgICAgc3dpdGNoICh0eXBlb2YgdGFyZ2V0KSB7XG4gICAgICAgIGNhc2UgJ3VuZGVmaW5lZCc6XG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGFyZ2V0IHx8ICdpZnJhbWUnKSxcbiAgICAgICAgICAgIGluaXQuYmluZCh1bmRlZmluZWQkMSwgb3B0aW9ucylcbiAgICAgICAgICApO1xuICAgICAgICAgIGJyZWFrXG5cbiAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgICBpbml0KG9wdGlvbnMsIHRhcmdldCk7XG4gICAgICAgICAgYnJlYWtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1VuZXhwZWN0ZWQgZGF0YSB0eXBlICgnICsgdHlwZW9mIHRhcmdldCArICcpJylcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGlGcmFtZXNcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBjcmVhdGVKUXVlcnlQdWJsaWNNZXRob2QoJCkge1xuICAgIGlmICghJC5mbikge1xuICAgICAgaW5mbygnJywgJ1VuYWJsZSB0byBiaW5kIHRvIGpRdWVyeSwgaXQgaXMgbm90IGZ1bGx5IGxvYWRlZC4nKTtcbiAgICB9IGVsc2UgaWYgKCEkLmZuLmlGcmFtZVJlc2l6ZSkge1xuICAgICAgJC5mbi5pRnJhbWVSZXNpemUgPSBmdW5jdGlvbiAkaUZyYW1lUmVzaXplRihvcHRpb25zKSB7XG4gICAgICAgIGZ1bmN0aW9uIGluaXQoaW5kZXgsIGVsZW1lbnQpIHtcbiAgICAgICAgICBzZXR1cElGcmFtZShlbGVtZW50LCBvcHRpb25zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlcignaWZyYW1lJykuZWFjaChpbml0KS5lbmQoKVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBpZiAod2luZG93LmpRdWVyeSkge1xuICAgIGNyZWF0ZUpRdWVyeVB1YmxpY01ldGhvZCh3aW5kb3cualF1ZXJ5KTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgdW5kZWZpbmVkJDEgPT09ICdmdW5jdGlvbicgJiYgdW5kZWZpbmVkJDEuYW1kKSB7XG4gICAgdW5kZWZpbmVkJDEoW10sIGZhY3RvcnkpO1xuICB9IGVsc2Uge1xuICAgIC8vIE5vZGUgZm9yIGJyb3dzZXJmeVxuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9XG4gIHdpbmRvdy5pRnJhbWVSZXNpemUgPSB3aW5kb3cuaUZyYW1lUmVzaXplIHx8IGZhY3RvcnkoKTtcbn0pKCk7XG59KTtcblxuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG4vKipcbiAqIFNpbWlsYXIgdG8gaW52YXJpYW50IGJ1dCBvbmx5IGxvZ3MgYSB3YXJuaW5nIGlmIHRoZSBjb25kaXRpb24gaXMgbm90IG1ldC5cbiAqIFRoaXMgY2FuIGJlIHVzZWQgdG8gbG9nIGlzc3VlcyBpbiBkZXZlbG9wbWVudCBlbnZpcm9ubWVudHMgaW4gY3JpdGljYWxcbiAqIHBhdGhzLiBSZW1vdmluZyB0aGUgbG9nZ2luZyBjb2RlIGZvciBwcm9kdWN0aW9uIGVudmlyb25tZW50cyB3aWxsIGtlZXAgdGhlXG4gKiBzYW1lIGxvZ2ljIGFuZCBmb2xsb3cgdGhlIHNhbWUgY29kZSBwYXRocy5cbiAqL1xuXG52YXIgX19ERVZfXyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbic7XG5cbnZhciB3YXJuaW5nID0gZnVuY3Rpb24oKSB7fTtcblxuaWYgKF9fREVWX18pIHtcbiAgdmFyIHByaW50V2FybmluZyA9IGZ1bmN0aW9uIHByaW50V2FybmluZyhmb3JtYXQsIGFyZ3MpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBhcmdzID0gbmV3IEFycmF5KGxlbiA+IDEgPyBsZW4gLSAxIDogMCk7XG4gICAgZm9yICh2YXIga2V5ID0gMTsga2V5IDwgbGVuOyBrZXkrKykge1xuICAgICAgYXJnc1trZXkgLSAxXSA9IGFyZ3VtZW50c1trZXldO1xuICAgIH1cbiAgICB2YXIgYXJnSW5kZXggPSAwO1xuICAgIHZhciBtZXNzYWdlID0gJ1dhcm5pbmc6ICcgK1xuICAgICAgZm9ybWF0LnJlcGxhY2UoLyVzL2csIGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gYXJnc1thcmdJbmRleCsrXTtcbiAgICAgIH0pO1xuICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAvLyAtLS0gV2VsY29tZSB0byBkZWJ1Z2dpbmcgUmVhY3QgLS0tXG4gICAgICAvLyBUaGlzIGVycm9yIHdhcyB0aHJvd24gYXMgYSBjb252ZW5pZW5jZSBzbyB0aGF0IHlvdSBjYW4gdXNlIHRoaXMgc3RhY2tcbiAgICAgIC8vIHRvIGZpbmQgdGhlIGNhbGxzaXRlIHRoYXQgY2F1c2VkIHRoaXMgd2FybmluZyB0byBmaXJlLlxuICAgICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuICAgIH0gY2F0Y2ggKHgpIHt9XG4gIH07XG5cbiAgd2FybmluZyA9IGZ1bmN0aW9uKGNvbmRpdGlvbiwgZm9ybWF0LCBhcmdzKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgYXJncyA9IG5ldyBBcnJheShsZW4gPiAyID8gbGVuIC0gMiA6IDApO1xuICAgIGZvciAodmFyIGtleSA9IDI7IGtleSA8IGxlbjsga2V5KyspIHtcbiAgICAgIGFyZ3Nba2V5IC0gMl0gPSBhcmd1bWVudHNba2V5XTtcbiAgICB9XG4gICAgaWYgKGZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgJ2B3YXJuaW5nKGNvbmRpdGlvbiwgZm9ybWF0LCAuLi5hcmdzKWAgcmVxdWlyZXMgYSB3YXJuaW5nICcgK1xuICAgICAgICAgICdtZXNzYWdlIGFyZ3VtZW50J1xuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKCFjb25kaXRpb24pIHtcbiAgICAgIHByaW50V2FybmluZy5hcHBseShudWxsLCBbZm9ybWF0XS5jb25jYXQoYXJncykpO1xuICAgIH1cbiAgfTtcbn1cblxudmFyIHdhcm5pbmdfMSA9IHdhcm5pbmc7XG5cbnZhciBmaWx0ZXJJZnJhbWVBdHRyaWJzID0gKGZ1bmN0aW9uIChwcm9wcykge1xuICB2YXIgYXV0b1Jlc2l6ZSA9IHByb3BzLmF1dG9SZXNpemUsXG4gICAgICBib2R5QmFja2dyb3VuZCA9IHByb3BzLmJvZHlCYWNrZ3JvdW5kLFxuICAgICAgYm9keU1hcmdpbiA9IHByb3BzLmJvZHlNYXJnaW4sXG4gICAgICBib2R5UGFkZGluZyA9IHByb3BzLmJvZHlQYWRkaW5nLFxuICAgICAgY2hlY2tPcmlnaW4gPSBwcm9wcy5jaGVja09yaWdpbixcbiAgICAgIGluUGFnZUxpbmtzID0gcHJvcHMuaW5QYWdlTGlua3MsXG4gICAgICBoZWlnaHRDYWxjdWxhdGlvbk1ldGhvZCA9IHByb3BzLmhlaWdodENhbGN1bGF0aW9uTWV0aG9kLFxuICAgICAgaW50ZXJ2YWwgPSBwcm9wcy5pbnRlcnZhbCxcbiAgICAgIGxvZyA9IHByb3BzLmxvZyxcbiAgICAgIG1heEhlaWdodCA9IHByb3BzLm1heEhlaWdodCxcbiAgICAgIG1heFdpZHRoID0gcHJvcHMubWF4V2lkdGgsXG4gICAgICBtaW5IZWlnaHQgPSBwcm9wcy5taW5IZWlnaHQsXG4gICAgICBtaW5XaWR0aCA9IHByb3BzLm1pbldpZHRoLFxuICAgICAgcmVzaXplRnJvbSA9IHByb3BzLnJlc2l6ZUZyb20sXG4gICAgICBzY3JvbGxpbmcgPSBwcm9wcy5zY3JvbGxpbmcsXG4gICAgICBzaXplSGVpZ2h0ID0gcHJvcHMuc2l6ZUhlaWdodCxcbiAgICAgIHNpemVXaWR0aCA9IHByb3BzLnNpemVXaWR0aCxcbiAgICAgIHdhcm5pbmdUaW1lb3V0ID0gcHJvcHMud2FybmluZ1RpbWVvdXQsXG4gICAgICB0b2xlcmFuY2UgPSBwcm9wcy50b2xlcmFuY2UsXG4gICAgICB3aWR0aENhbGN1bGF0aW9uTWV0aG9kID0gcHJvcHMud2lkdGhDYWxjdWxhdGlvbk1ldGhvZCxcbiAgICAgIG9uQ2xvc2VkID0gcHJvcHMub25DbG9zZWQsXG4gICAgICBvbkluaXQgPSBwcm9wcy5vbkluaXQsXG4gICAgICBvbk1lc3NhZ2UgPSBwcm9wcy5vbk1lc3NhZ2UsXG4gICAgICBvbk1vdXNlRW50ZXIgPSBwcm9wcy5vbk1vdXNlRW50ZXIsXG4gICAgICBvbk1vdXNlTGVhdmUgPSBwcm9wcy5vbk1vdXNlTGVhdmUsXG4gICAgICBvblJlc2l6ZWQgPSBwcm9wcy5vblJlc2l6ZWQsXG4gICAgICBpZnJhbWVQcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKHByb3BzLCBbXCJhdXRvUmVzaXplXCIsIFwiYm9keUJhY2tncm91bmRcIiwgXCJib2R5TWFyZ2luXCIsIFwiYm9keVBhZGRpbmdcIiwgXCJjaGVja09yaWdpblwiLCBcImluUGFnZUxpbmtzXCIsIFwiaGVpZ2h0Q2FsY3VsYXRpb25NZXRob2RcIiwgXCJpbnRlcnZhbFwiLCBcImxvZ1wiLCBcIm1heEhlaWdodFwiLCBcIm1heFdpZHRoXCIsIFwibWluSGVpZ2h0XCIsIFwibWluV2lkdGhcIiwgXCJyZXNpemVGcm9tXCIsIFwic2Nyb2xsaW5nXCIsIFwic2l6ZUhlaWdodFwiLCBcInNpemVXaWR0aFwiLCBcIndhcm5pbmdUaW1lb3V0XCIsIFwidG9sZXJhbmNlXCIsIFwid2lkdGhDYWxjdWxhdGlvbk1ldGhvZFwiLCBcIm9uQ2xvc2VkXCIsIFwib25Jbml0XCIsIFwib25NZXNzYWdlXCIsIFwib25Nb3VzZUVudGVyXCIsIFwib25Nb3VzZUxlYXZlXCIsIFwib25SZXNpemVkXCJdKTtcblxuICByZXR1cm4gaWZyYW1lUHJvcHM7XG59KTtcblxudmFyIElmcmFtZVJlc2l6ZXIgPSBmdW5jdGlvbiBJZnJhbWVSZXNpemVyKHByb3BzKSB7XG4gIHZhciB0aXRsZSA9IHByb3BzLnRpdGxlLFxuICAgICAgZm9yd2FyZFJlZiA9IHByb3BzLmZvcndhcmRSZWYsXG4gICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UocHJvcHMsIFtcInRpdGxlXCIsIFwiZm9yd2FyZFJlZlwiXSk7XG5cbiAgdmFyIGlmcmFtZVByb3BzID0gZmlsdGVySWZyYW1lQXR0cmlicyhyZXN0KTtcbiAgdmFyIGlmcmFtZVJlZiA9IFJlYWN0LnVzZVJlZihudWxsKTtcblxuICB2YXIgb25DbG9zZSA9IGZ1bmN0aW9uIG9uQ2xvc2UoKSB7XG4gICAgd2FybmluZ18xKCFpZnJhbWVSZWYuY3VycmVudCwgXCJbaWZyYW1lU2l6ZXJSZWFjdF1bXCIgKyAoaWZyYW1lUmVmICYmIGlmcmFtZVJlZi5jdXJyZW50ICYmIGlmcmFtZVJlZi5jdXJyZW50LmlkKSArIFwiXSBDbG9zZSBldmVudCBpZ25vcmVkLCB0byByZW1vdmUgdGhlIGlmcmFtZSB1cGRhdGUgeW91ciBSZWFjdCBjb21wb25lbnRcIik7XG4gICAgcmV0dXJuICFpZnJhbWVSZWYuY3VycmVudDtcbiAgfTsgLy8gVGhpcyBob29rIGlzIG9ubHkgcnVuIG9uY2UsIGFzIG9uY2UgaWZyYW1lUmVzaXplciBpcyBib3VuZCwgaXQgd2lsbFxuICAvLyBkZWFsIHdpdGggY2hhbmdlcyB0byB0aGUgZWxlbWVudCBhbmQgZG9lcyBub3QgbmVlZCByZWNhbGxpbmdcblxuXG4gIFJlYWN0LnVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGlmcmFtZSA9IGlmcmFtZVJlZi5jdXJyZW50O1xuICAgIGlmcmFtZVJlc2l6ZXIoX2V4dGVuZHMoe30sIHJlc3QsIHtcbiAgICAgIG9uQ2xvc2U6IG9uQ2xvc2VcbiAgICB9KSwgaWZyYW1lKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGlmcmFtZS5pRnJhbWVSZXNpemVyICYmIGlmcmFtZS5pRnJhbWVSZXNpemVyLnJlbW92ZUxpc3RlbmVycygpO1xuICAgIH07XG4gIH0sIFtdKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcblxuICBSZWFjdC51c2VJbXBlcmF0aXZlSGFuZGxlKGZvcndhcmRSZWYsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzaXplOiBmdW5jdGlvbiByZXNpemUoKSB7XG4gICAgICAgIHJldHVybiBpZnJhbWVSZWYuY3VycmVudC5pRnJhbWVSZXNpemVyLnJlc2l6ZSgpO1xuICAgICAgfSxcbiAgICAgIG1vdmVUb0FuY2hvcjogZnVuY3Rpb24gbW92ZVRvQW5jaG9yKGFuY2hvcikge1xuICAgICAgICByZXR1cm4gaWZyYW1lUmVmLmN1cnJlbnQuaUZyYW1lUmVzaXplci5tb3ZlVG9BbmNob3IoYW5jaG9yKTtcbiAgICAgIH0sXG4gICAgICBzZW5kTWVzc2FnZTogZnVuY3Rpb24gc2VuZE1lc3NhZ2UobWVzc2FnZSwgdGFyZ2V0T3JpZ2luKSB7XG4gICAgICAgIGlmcmFtZVJlZi5jdXJyZW50LmlGcmFtZVJlc2l6ZXIuc2VuZE1lc3NhZ2UobWVzc2FnZSwgdGFyZ2V0T3JpZ2luKTtcbiAgICAgIH1cbiAgICB9O1xuICB9KTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdFsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIiwgX2V4dGVuZHMoe1xuICAgIHRpdGxlOiB0aXRsZVxuICB9LCBpZnJhbWVQcm9wcywge1xuICAgIHJlZjogaWZyYW1lUmVmXG4gIH0pKTtcbn07XG5cbklmcmFtZVJlc2l6ZXIuZGVmYXVsdFByb3BzID0ge1xuICB0aXRsZTogJ2lmcmFtZSdcbn07XG5JZnJhbWVSZXNpemVyLnByb3BUeXBlcyA9IHtcbiAgdGl0bGU6IFByb3BUeXBlc19fZGVmYXVsdFsnZGVmYXVsdCddLnN0cmluZ1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBJZnJhbWVSZXNpemVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/iframe-resizer-react/dist/index.js\n");

/***/ })

};
;